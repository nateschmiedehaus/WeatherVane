(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[142],{6142:function(e,t,a){"use strict";a.d(t,{P:function(){return m}});var i=a(5893),n=a(7294),s=a(7437),o=a.n(s),l=a(8680);let d={approved:"Shipped",pending:"Needs review",shadow:"Shadow rehearsal"},r={approved:"success",pending:"caution",shadow:"info"},c={approved:"Monitor live performance; trigger a rollback if the trend slips.",pending:"Approve or request changes before the review window closes.",shadow:"Promote this rehearsal once your spot checks align with the evidence."},u=[{id:"all",label:"All changes",description:"Every automated change captured here."},{id:"pending",label:"Needs review",description:"Actions waiting on your approval."},{id:"approved",label:"Shipped",description:"Live changes already executed by automation."},{id:"shadow",label:"Rehearsals",description:"Shadow runs proving the plan is safe."}];function m(e){var t,a;let{audits:s,title:m="Automation change log",metaLabel:h,loading:p=!1,isFallback:v=!1,errorMessage:g,emptyMessage:_="Change history appears once WeatherVane makes its first move.",limit:f,className:x}=e,b=(0,l.dg)(s),[N,y]=(0,n.useState)(()=>(0,l.ht)(s)),[j,w]=(0,n.useState)(!1),A=(0,n.useMemo)(()=>{let e={approved:0,pending:0,shadow:0};for(let t of s)e[t.status]+=1;return e},[s]),B=A.pending>0,k=(0,n.useMemo)(()=>{let e=new Map;for(let t of b.metrics)("approved"===t.id||"pending"===t.id||"shadow"===t.id)&&e.set(t.id,t.value);return e},[b.metrics]);(0,n.useEffect)(()=>{let e=(0,l.ht)(s);y(t=>"pending"!==t||B?j||"all"!==t||"pending"!==e?t:"pending":e)},[s,B,j]),(0,n.useEffect)(()=>{B||w(!1)},[B]);let S=(0,n.useMemo)(()=>(0,l.jf)(s,N),[s,N]),C=(0,n.useMemo)(()=>"number"==typeof f?S.slice(0,f):S,[S,f]),M=s.length,L=S.length,V=[o().container,"ds-surface-panel","ds-transition",x].filter(Boolean).join(" "),W=null!=h?h:"Transparent by design",R=u.map(e=>{let t="all"!==e.id&&0===A[e.id];return{...e,disabled:t}}),E=0===C.length&&"all"!==N&&null!==(a=({pending:"You're caught up — WeatherVane will alert you when a new review lands.",approved:"Automation hasn't shipped a change yet. Once it does, the story lands here.",shadow:"No rehearsals recorded yet. WeatherVane runs one before first launch."})[N])&&void 0!==a?a:_;return(0,i.jsxs)("section",{className:V,"aria-live":"polite","data-testid":"automation-change-log",children:[(0,i.jsxs)("header",{className:o().header,children:[(0,i.jsxs)("div",{className:o().titleRow,children:[(0,i.jsx)("h5",{className:"ds-subtitle",children:m}),(0,i.jsxs)("div",{className:o().meta,children:[W&&(0,i.jsx)("span",{className:"ds-caption",children:W}),p?(0,i.jsx)("span",{className:"ds-badge ".concat(o().badge),"data-tone":"info",children:"Syncing…"}):v?(0,i.jsx)("span",{className:"ds-badge ".concat(o().badge),"data-tone":"info",children:"Demo proof"}):(0,i.jsx)("span",{className:"ds-badge ".concat(o().badge),"data-tone":"success",children:"Live proof"})]})]}),g&&(0,i.jsxs)("p",{className:"".concat(o().notice," ds-caption"),role:"status",children:["Showing demo log while the live feed loads — ",g]})]}),b&&(0,i.jsxs)("div",{className:o().summary,"data-tone":b.tone,role:"status","aria-live":"polite","data-testid":"automation-change-log-summary",children:[(0,i.jsxs)("div",{className:o().summaryCopy,children:[(0,i.jsx)("p",{className:"ds-body-strong",children:b.headline}),(0,i.jsx)("p",{className:"ds-caption",children:b.subline}),b.nextAction&&(0,i.jsxs)("p",{className:"".concat(o().summaryAction," ds-caption-strong"),"data-testid":"automation-summary-next-action",children:["Next: ",b.nextAction]})]}),(0,i.jsx)("dl",{className:o().summaryMetrics,children:b.metrics.map(e=>(0,i.jsxs)("div",{className:o().summaryMetric,"data-tone":e.tone,children:[(0,i.jsx)("dt",{className:"ds-caption",children:e.label}),(0,i.jsx)("dd",{className:"ds-title-xs",children:e.value})]},e.id))})]}),(0,i.jsxs)("fieldset",{className:o().filters,"aria-label":"Filter change log",children:[(0,i.jsx)("legend",{className:"ds-caption",children:"Show me"}),(0,i.jsx)("div",{className:o().filterGroup,role:"toolbar","aria-label":"Change log filters","data-testid":"automation-change-log-filters",children:R.map(e=>{var t;return(0,i.jsxs)("button",{type:"button",className:"".concat(o().filterButton," ds-pill ds-caption-strong"),"data-active":N===e.id?"true":void 0,"data-testid":"automation-filter-".concat(e.id),onClick:()=>{y(e.id),w(!0)},disabled:e.disabled,"aria-pressed":N===e.id,"aria-label":"".concat(e.label).concat(e.disabled?" (no entries yet)":""),title:e.description,children:[(0,i.jsx)("span",{className:o().filterLabel,children:e.label}),(0,i.jsx)("span",{className:o().filterCount,"data-testid":"automation-filter-count-".concat(e.id),children:"all"===e.id?M:null!==(t=k.get(e.id))&&void 0!==t?t:"0"})]},e.id)})}),(0,i.jsx)("p",{className:"".concat(o().filterHint," ds-caption"),children:"all"===N?"Showing ".concat(L," change").concat(1===L?"":"s"," from newest to oldest."):"Showing ".concat(L," ").concat(null===(t=R.find(e=>e.id===N))||void 0===t?void 0:t.label.toLowerCase()," entr").concat(1===L?"y":"ies",".")})]}),0===C.length?(0,i.jsx)("p",{className:"".concat(o().empty," ds-body"),children:E}):(0,i.jsx)("ul",{className:o().list,children:C.map(e=>{var t,a,n,s,u,m,h,p,v,g,_,f,x,b;let N=(0,l.Qz)(e),y=d[e.status],j=N?"".concat(y," — approval overdue"):y;return(0,i.jsxs)("li",{className:"".concat(o().item," ds-surface-card ds-transition"),"data-tone":r[e.status],"data-status":e.status,"data-overdue":N?"true":void 0,"data-testid":"automation-change-log-item","data-log-id":e.id,children:[(0,i.jsxs)("header",{className:o().itemHeader,children:[(0,i.jsxs)("div",{className:o().itemTitle,children:[(0,i.jsx)("span",{className:"ds-caption-strong",children:"What changed"}),(0,i.jsx)("strong",{className:"ds-body-strong",children:e.headline})]}),(0,i.jsx)("span",{className:"ds-badge ".concat(o().statusBadge),"data-tone":r[e.status],title:j,children:y})]}),(0,i.jsxs)("div",{className:o().narrativeGrid,children:[(0,i.jsxs)("div",{className:o().narrativeBlock,children:[(0,i.jsx)("span",{className:"ds-caption-strong",children:"Why WeatherVane moved"}),(0,i.jsx)("p",{className:"ds-body","data-testid":"automation-narrative-why",children:null!==(v=null===(t=e.narrative)||void 0===t?void 0:t.why)&&void 0!==v?v:e.detail})]}),(0,i.jsxs)("div",{className:"".concat(o().narrativeBlock," ").concat(o().impactBlock),children:[(0,i.jsx)("span",{className:"ds-caption-strong",children:"Impact so far"}),(0,i.jsxs)("div",{className:o().impactValue,"data-testid":"automation-narrative-impact",children:[(0,i.jsx)("strong",{className:"ds-title-xs",children:null!==(g=null===(a=e.narrative)||void 0===a?void 0:a.impactValue)&&void 0!==g?g:"—"}),(0,i.jsx)("span",{className:"ds-caption",children:null!==(_=null===(n=e.narrative)||void 0===n?void 0:n.impactLabel)&&void 0!==_?_:"Impact"})]}),((null===(s=e.narrative)||void 0===s?void 0:s.impactContext)||(null===(u=e.narrative)||void 0===u?void 0:u.impact))&&(0,i.jsx)("p",{className:"ds-caption","data-testid":"automation-narrative-impact-context",children:null!==(f=null===(m=e.narrative)||void 0===m?void 0:m.impactContext)&&void 0!==f?f:null===(h=e.narrative)||void 0===h?void 0:h.impact})]}),(0,i.jsxs)("div",{className:o().narrativeBlock,children:[(0,i.jsx)("span",{className:"ds-caption-strong",children:"Next step"}),(0,i.jsx)("p",{className:"ds-body","data-testid":"automation-narrative-next-step",children:null!==(x=null===(p=e.narrative)||void 0===p?void 0:p.nextStep)&&void 0!==x?x:c[e.status]})]})]}),e.actions&&e.actions.length>0&&(0,i.jsx)("div",{className:o().actions,children:e.actions.map(e=>{var t,a,n;let s=null!==(t=e.intent)&&void 0!==t?t:"acknowledge";return e.href?(0,i.jsx)("a",{className:"".concat(o().actionButton," ds-pill ds-caption-strong"),"data-intent":s,href:e.href,title:null!==(a=e.tooltip)&&void 0!==a?a:e.label,children:e.label},e.id):(0,i.jsx)("button",{type:"button",className:"".concat(o().actionButton," ds-pill ds-caption-strong"),"data-intent":s,title:null!==(n=e.tooltip)&&void 0!==n?n:e.label,children:e.label},e.id)})}),e.evidence&&e.evidence.length>0&&(0,i.jsxs)("div",{className:o().evidence,role:"group","aria-label":"Evidence for ".concat(e.headline),children:[(0,i.jsx)("div",{className:o().evidenceBadges,children:e.evidence.slice(0,3).map(e=>{var t;return(0,i.jsxs)("span",{className:"".concat(o().evidenceBadge," ds-caption"),"data-tone":null!==(t=e.tone)&&void 0!==t?t:"info",children:[(0,i.jsx)("span",{className:o().evidenceBadgeLabel,children:e.label}),(0,i.jsx)("strong",{className:o().evidenceBadgeValue,children:e.value})]},e.id)})}),(0,i.jsxs)("details",{className:o().evidenceDetails,children:[(0,i.jsxs)("summary",{className:"".concat(o().evidenceSummary," ds-caption-strong"),children:["Evidence packet ",(0,i.jsxs)("span",{className:o().evidenceCount,children:["(",e.evidence.length,")"]})]}),(0,i.jsx)("ul",{className:o().evidenceList,children:e.evidence.map(e=>{var t;return(0,i.jsxs)("li",{className:o().evidenceItem,"data-tone":null!==(t=e.tone)&&void 0!==t?t:"info",children:[(0,i.jsxs)("div",{className:o().evidenceItemHeader,children:[(0,i.jsx)("span",{className:"ds-caption-strong",children:e.label}),(0,i.jsx)("span",{className:"ds-body-strong",children:e.value})]}),e.context&&(0,i.jsx)("p",{className:"ds-caption",children:e.context}),e.link&&(0,i.jsx)("a",{className:"".concat(o().evidenceLink," ds-caption"),href:e.link.href,target:"_blank",rel:"noopener noreferrer",children:e.link.label})]},e.id)})})]})]}),(0,i.jsxs)("footer",{className:"".concat(o().footer," ds-caption"),children:[(0,i.jsx)("span",{children:null!==(b=e.actor)&&void 0!==b?b:"WeatherVane"}),(0,i.jsx)("span",{children:e.timeAgo})]})]},e.id)})})]})}},8680:function(e,t,a){"use strict";a.d(t,{QL:function(){return r},Qz:function(){return u},dg:function(){return c},ht:function(){return n},jf:function(){return d}});let i={tone:"info",headline:"Awaiting first WeatherVane change",subline:"WeatherVane will publish the story, evidence, and next step here once Automation engine ships or requests your review.",metrics:[{id:"approved",label:"Shipped",value:"0",tone:"info"},{id:"pending",label:"Needs review",value:"0",tone:"info"},{id:"shadow",label:"Rehearsals",value:"0",tone:"info"}]};function n(e){return e.some(e=>"pending"===e.status)?"pending":(e.length,"all")}function s(e,t){return e.reduce((e,a)=>a.status===t?e+1:e,0)}function o(e){return"number"==typeof e.minutesAgo&&Number.isFinite(e.minutesAgo)?e.minutesAgo:function(e){if(!e)return null;let t=e.trim().toLowerCase();if(!t)return null;if("just now"===t)return 0;let a=t.match(/(\d+(\.\d+)?)/);if(!a)return null;let i=Number.parseFloat(a[1]);return Number.isFinite(i)?/\bweek/.test(t)||t.endsWith("w")||/\dw\b/.test(t)?Math.round(10080*i):/\bday/.test(t)||t.endsWith("d")||/\dd\b/.test(t)?Math.round(1440*i):/\bhour/.test(t)||/\bhr/.test(t)||t.endsWith("h")||/\dh\b/.test(t)?Math.round(60*i):/\bmin/.test(t)||t.endsWith("m")||/\dm\b/.test(t)?Math.round(i):null:null}(e.timeAgo)}function l(e,t){let a;for(let i of e){if(i.status!==t)continue;let e=o(i);if(!a){a={audit:i,minutes:e};continue}(null!==e||null!==a.minutes)&&null!==e&&(null===a.minutes||e<a.minutes)&&(a={audit:i,minutes:e})}return null==a?void 0:a.audit}function d(e,t){return"all"===t?e:e.filter(e=>e.status===t)}function r(e){var t,a;let i=Array.isArray(e)?e:[],n=s(i,"approved"),d=s(i,"pending"),r=s(i,"shadow"),c=i.filter(e=>u(e)).length,m=l(i,"approved"),h=l(i,"pending");return{approvedCount:n,pendingCount:d,shadowCount:r,overdueCount:c,latestApprovedMinutes:m&&null!==(t=o(m))&&void 0!==t?t:null,latestPendingMinutes:h&&null!==(a=o(h))&&void 0!==a?a:null,hasAudits:i.length>0}}function c(e){if(!e||0===e.length)return i;let t=s(e,"approved"),a=s(e,"pending"),n=s(e,"shadow"),d=function(e,t,a,i){let n=e.length;return[{id:"approved",label:"Shipped",value:String(t),tone:t>0?"success":"info"},{id:"pending",label:"Needs review",value:String(a),tone:a>0?"caution":"info"},{id:"shadow",label:"Rehearsals",value:String(i),tone:i>0?"info":n>0?"success":"info"}]}(e,t,a,n);return a>0?function(e,t,a){var i,n,s,d,r,c,u,m,h;let p=l(e,"pending"),v=e.filter(e=>"pending"===e.status).map(e=>({audit:e,minutes:o(e)})).filter(e=>null!==e.minutes&&e.minutes>=1440),g=v.length,_=null!==(s=null==p?void 0:null===(i=p.narrative)||void 0===i?void 0:i.why)&&void 0!==s?s:null==p?void 0:p.detail,f=null!=_?_:"WeatherVane is holding recent moves until an approver signs off. Guardrails are still protecting live spend.",x=null!==(d=null==p?void 0:null===(n=p.narrative)||void 0===n?void 0:n.nextStep)&&void 0!==d?d:"Approve or request changes within ".concat(24,"h to keep Automation engine on schedule.");if(g>0){let e=v.reduce((e,t)=>t.minutes>e.minutes?t:e),t=(h=e.minutes)>=1440?"".concat(Math.round(h/1440),"d"):h>=60?"".concat(Math.round(h/60),"h"):"".concat(h,"m"),a=null!==(m=null===(r=e.audit.narrative)||void 0===r?void 0:r.why)&&void 0!==m?m:e.audit.detail;f=a?"".concat(a," WeatherVane has held this change ").concat(t," past the ").concat(24,"h review window."):"WeatherVane has held the pending change ".concat(t," past the ").concat(24,"h review window.");let i="Escalate to Director Dana or delegate backup coverage so Automation engine can resume safely.";x=(null===(c=e.audit.narrative)||void 0===c?void 0:c.nextStep)?"".concat(e.audit.narrative.nextStep," ").concat(i):(null==p?void 0:null===(u=p.narrative)||void 0===u?void 0:u.nextStep)&&p.id!==e.audit.id?"".concat(p.narrative.nextStep," ").concat(i):"Assign an approver immediately. ".concat(i)}return{tone:"caution",headline:g>0?1===g?"1 approval overdue — Automation engine still waiting":"".concat(g," approvals overdue — Automation engine still waiting"):1===a?"1 change needs your approval":"".concat(a," changes need your approval"),subline:f,nextAction:x,metrics:t}}(e,d,a):t>0?function(e,t,a,i){var n,s,o;let d=l(e,"approved"),r=l(e,"shadow"),c=[];return(null==d?void 0:null===(n=d.narrative)||void 0===n?void 0:n.impact)?c.push(d.narrative.impact):(null==d?void 0:null===(s=d.narrative)||void 0===s?void 0:s.impactContext)?c.push(d.narrative.impactContext):c.push("Guardrails held steady and the move stayed inside the safety band."),(null==d?void 0:d.timeAgo)&&c.push("Last shipped ".concat(d.timeAgo,".")),i>0&&(null==r?void 0:null===(o=r.narrative)||void 0===o?void 0:o.nextStep)&&c.push(r.narrative.nextStep),{tone:"success",headline:1===a?"Automation engine shipped 1 change":"Automation engine shipped ".concat(a," changes"),subline:c.join(" "),metrics:t}}(e,d,t,n):function(e,t,a){var i,n,s,o;let d=l(e,"shadow"),r=null!==(s=null==d?void 0:null===(i=d.narrative)||void 0===i?void 0:i.impactContext)&&void 0!==s?s:"Rehearsals prove the rollback path and retention hooks before Automation engine ships live changes.",c=null!==(o=null==d?void 0:null===(n=d.narrative)||void 0===n?void 0:n.nextStep)&&void 0!==o?o:"Promote the rehearsal once manual spot checks align with expectations.";return{tone:"info",headline:1===a?"Shadow rehearsal ready for promotion":"".concat(a," shadow rehearsals ready for promotion"),subline:r,nextAction:c,metrics:t}}(e,d,n)}function u(e){if("pending"!==e.status)return!1;let t=o(e);return null!==t&&t>=1440}},7437:function(e){e.exports={container:"automation-audit-list_container__TpINc",header:"automation-audit-list_header__jqkLb",summary:"automation-audit-list_summary__N4P8l",summaryCopy:"automation-audit-list_summaryCopy__BPJQb",summaryAction:"automation-audit-list_summaryAction__AvFaX",summaryMetrics:"automation-audit-list_summaryMetrics__KSPlE",summaryMetric:"automation-audit-list_summaryMetric__h4zmE",filters:"automation-audit-list_filters__euoIk",filterGroup:"automation-audit-list_filterGroup__uua85",filterButton:"automation-audit-list_filterButton__7NURZ",filterLabel:"automation-audit-list_filterLabel__Td4yM",filterCount:"automation-audit-list_filterCount__X_WJ9",filterHint:"automation-audit-list_filterHint__rbMTm",titleRow:"automation-audit-list_titleRow__Wf_qS",meta:"automation-audit-list_meta__KRlPM",badge:"automation-audit-list_badge___2z2b",notice:"automation-audit-list_notice__Cppe6",list:"automation-audit-list_list__St9r3",item:"automation-audit-list_item__xUfGl",statusBadge:"automation-audit-list_statusBadge__yG0Tn",itemHeader:"automation-audit-list_itemHeader__xFVvb",itemTitle:"automation-audit-list_itemTitle__i7R3h",narrativeGrid:"automation-audit-list_narrativeGrid__YlTo9",narrativeBlock:"automation-audit-list_narrativeBlock__B1bfy",impactBlock:"automation-audit-list_impactBlock__mCnyr",impactValue:"automation-audit-list_impactValue__dBmA3",actions:"automation-audit-list_actions__1JQRn",actionButton:"automation-audit-list_actionButton__r_kNz",footer:"automation-audit-list_footer__PSas8",empty:"automation-audit-list_empty___7HZB",evidence:"automation-audit-list_evidence__8XJ9J",evidenceBadges:"automation-audit-list_evidenceBadges__I4J6s",evidenceBadge:"automation-audit-list_evidenceBadge__Vwv9r",evidenceBadgeLabel:"automation-audit-list_evidenceBadgeLabel__fKq0B",evidenceBadgeValue:"automation-audit-list_evidenceBadgeValue__e7EFy",evidenceDetails:"automation-audit-list_evidenceDetails__KkX_A",evidenceSummary:"automation-audit-list_evidenceSummary__gh8b0",evidenceCount:"automation-audit-list_evidenceCount__PYwAR",evidenceList:"automation-audit-list_evidenceList__pf_PW",evidenceItem:"automation-audit-list_evidenceItem__TJCm_",evidenceItemHeader:"automation-audit-list_evidenceItemHeader__RU_Fa",evidenceLink:"automation-audit-list_evidenceLink__VbpG5"}}}]);