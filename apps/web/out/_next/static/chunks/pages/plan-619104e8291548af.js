(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[211],{1179:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plan",function(){return a(1253)}])},5795:function(e,n,a){"use strict";a.d(n,{O:function(){return l}});var t=a(5893),s=a(7294),i=a(5201),r=a.n(i);function l(e){let{title:n="Data context",tags:a=[],warnings:i=[]}=e,l=(0,s.useId)();if(0===a.length&&0===i.length)return null;let o=i.some(e=>"string"==typeof e.severity&&"critical"===e.severity.toLowerCase()),c=e=>{let n="string"==typeof e?e.toLowerCase():"";return"critical"===n?r().warningCritical:"warning"===n?r().warningCaution:r().warningInfo};return(0,t.jsxs)("section",{className:"".concat(r().panel," ds-surface-panel"),"aria-labelledby":l,role:"region",children:[(0,t.jsxs)("div",{className:r().header,children:[(0,t.jsx)("h3",{id:l,className:"".concat(r().heading," ds-title"),children:n}),o&&(0,t.jsx)("span",{className:"ds-badge","data-tone":"critical",children:"Action needed"})]}),a.length>0&&(0,t.jsx)("p",{className:"".concat(r().tags," ds-caption"),children:a.join(", ")}),i.length>0&&(0,t.jsx)("ul",{className:r().warningList,"aria-live":"polite",children:i.map(e=>{var n;return(0,t.jsxs)("li",{className:"".concat(r().warningItem," ").concat(c(e.severity)),children:[(0,t.jsx)("strong",{className:"ds-caption",children:(null!==(n=e.severity)&&void 0!==n?n:"warning").toUpperCase()}),(0,t.jsx)("span",{className:"ds-body",children:e.message})]},e.code)})})]})}},9605:function(e,n,a){"use strict";a.d(n,{B:function(){return o}});var t=a(5893),s=a(4221),i=a.n(s);let r={ready:"Connected",in_progress:"Configuring",action_needed:"Action needed"},l={ready:"success",in_progress:"caution",action_needed:"critical"};function o(e){let{connectors:n,title:a="Connector readiness",metaLabel:s,loading:o=!1,isFallback:c=!1,errorMessage:d,emptyMessage:p="Connectors will appear here after your first ingestion run completes.",limit:m,className:u}=e,h="number"==typeof m?n.slice(0,m):n,g=[i().container,"ds-surface-panel","ds-transition",u].filter(Boolean).join(" ");return(0,t.jsxs)("section",{className:g,"aria-live":"polite",children:[(0,t.jsxs)("header",{className:i().header,children:[(0,t.jsxs)("div",{className:i().titleRow,children:[(0,t.jsx)("h5",{className:"ds-subtitle",children:a}),(0,t.jsxs)("div",{className:i().meta,children:[s&&(0,t.jsx)("span",{className:"ds-caption",children:s}),(0,t.jsx)("div",{className:i().metaBadges,children:o?(0,t.jsx)("span",{className:"ds-badge ".concat(i().badge),"data-tone":"info",children:"Syncing…"}):c?(0,t.jsx)("span",{className:"ds-badge ".concat(i().badge),"data-tone":"info",children:"Demo snapshot"}):(0,t.jsx)("span",{className:"ds-badge ".concat(i().badge),"data-tone":"success",children:"Live snapshot"})})]})]}),d&&(0,t.jsxs)("p",{className:"".concat(i().notice," ds-caption"),role:"status",children:["Showing demo data while the live snapshot loads — ",d]})]}),0===h.length?(0,t.jsx)("p",{className:"".concat(i().empty," ds-body"),children:p}):(0,t.jsx)("ul",{className:i().list,children:h.map(e=>(0,t.jsxs)("li",{className:"".concat(i().item," ds-surface-card ds-transition"),"data-status":e.status,"data-tone":l[e.status],children:[(0,t.jsxs)("div",{className:i().itemHeader,children:[(0,t.jsx)("strong",{className:"ds-body-strong",children:e.label}),(0,t.jsx)("span",{className:"ds-badge ".concat(i().statusBadge),"data-tone":l[e.status],children:r[e.status]})]}),e.summary&&(0,t.jsx)("p",{className:"".concat(i().summary," ds-body"),children:e.summary}),(0,t.jsxs)("div",{className:"".concat(i().progressRow," ds-caption"),children:[(0,t.jsxs)("span",{children:[e.progress,"%"]}),(0,t.jsx)("div",{className:i().progressBar,"aria-hidden":"true",children:(0,t.jsx)("div",{className:i().progressFill,style:{transform:"scaleX(".concat(Math.max(e.progress,0)/100,")")}})}),e.focus&&(0,t.jsx)("span",{children:e.focus})]}),(0,t.jsxs)("div",{className:"".concat(i().footer," ds-caption"),children:[(0,t.jsx)("span",{children:e.timeAgo}),e.action&&(0,t.jsx)("span",{className:"".concat(i().action," ds-pill"),children:e.action})]})]},e.slug))})]})}},918:function(e,n,a){"use strict";a.d(n,{P:function(){return o}});var t=a(5893),s=a(7294),i=function(){for(var e,n,a=0,t="",s=arguments.length;a<s;a++)(e=arguments[a])&&(n=function e(n){var a,t,s="";if("string"==typeof n||"number"==typeof n)s+=n;else if("object"==typeof n){if(Array.isArray(n)){var i=n.length;for(a=0;a<i;a++)n[a]&&(t=e(n[a]))&&(s&&(s+=" "),s+=t)}else for(t in n)n[t]&&(s&&(s+=" "),s+=t)}return s}(e))&&(t&&(t+=" "),t+=n);return t},r=a(1682),l=a.n(r);let o=(0,s.forwardRef)((e,n)=>{let{className:a,type:s,loading:r=!1,loadingText:o,disabled:c,children:d,...p}=e,m=!!r,u=m&&null!=o?o:d;return(0,t.jsx)("button",{...p,ref:n,type:null!=s?s:"button",className:i("ds-body-strong",l().retryButton,m&&l().retryButtonLoading,a),disabled:c||m,"data-loading":m||void 0,"aria-busy":!!m||void 0,children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{"aria-hidden":!0,className:l().retryButtonSpinner}),(0,t.jsx)("span",{className:l().retryButtonLabel,children:u})]}):u})});o.displayName="RetryButton"},1162:function(e,n,a){"use strict";a.d(n,{Y:function(){return l}});let t=e=>{let n=new Date;return n.setHours(0,0,0,0),n.setDate(n.getDate()+e),n.toISOString().slice(0,10)},s={meta:{channel:"Meta Advantage+",headline:"Meta Advantage+ warm weather audiences ready for surge",supporting:["Heatwave cohorts historically lift Meta conversion rate 18-24%","Creative set `Sunrise Splash` optimized for high UV index days"]},google:{channel:"Google Search",headline:"High-intent queries climbing ahead of weather swing",supporting:["Weather-triggered bid rules show +32% impression share during anomalies","Branded queries hold steady; non-brand 'cooler deals' up 44%"]},email:{channel:"Klaviyo Email",headline:"Weather-conditioned lifecycle campaign primed for max reach",supporting:["Segment `Heat Relief VIP` shows 58% open rate during >95\xb0F streaks","Pre-approved copy variation and assets already localized for TX + AZ"]},pos:{channel:"Shopify POS",headline:"In-store traffic spikes with localized forecast signage",supporting:["Geofenced push notifications lift footfall 21% during cold snaps","Inventory buffer holds 4.2 days of surge-ready stock in top stores"]}},i={manual:{label:"Manual mode (review every recommendation)",guardrail:"Guardrails stay enforced; no automated pushes without sign-off."},assist:{label:"Assist mode (one-click approvals)",guardrail:"Assist queue batches approvals at 7am local time; guardrails re-check before push."},automation:{label:"Automation engine mode (hands-off within limits)",guardrail:"Automation engine respects daily delta caps and resets to Assist when guardrail breaches occur."}},r=[{plan_date:t(1),geo_group_id:"Texas \xb7 Gulf Region",category:"Cooling \xb7 Summer Essentials",channel:"Meta Advantage+",recommended_spend:4200,expected_revenue:{p10:6800,p50:11200,p90:14800},expected_roas:{p10:1.6,p50:2.67,p90:3.52},confidence:"HIGH",assumptions:["Historical conversion lift persists above 95\xb0F heat index"],rationale:{primary_driver:"Heatwave (Δ +11\xb0F) with dew point surge lifting beverage demand",supporting_factors:["Three-day forecast with sustained UV index ≥8","Meta Advantage+ audiences historically convert 22% better during heat anomalies","Inventory levels at 96% of safety stock threshold"],confidence_level:"HIGH",data_quality:"Weather + commerce backtest coverage 98%",assumptions:["Creative set localized for TX already approved"],risks:["Heat index above 105\xb0F can reduce in-store traffic if not paired with delivery CTA"]}},{plan_date:t(2),geo_group_id:"Colorado Front Range",category:"Outerwear \xb7 Cold Weather",channel:"Google Search",recommended_spend:2600,expected_revenue:{p10:4100,p50:7200,p90:9300},expected_roas:{p10:1.55,p50:2.77,p90:3.58},confidence:"MEDIUM",assumptions:["Snow advisory triggers same-day demand spike"],rationale:{primary_driver:"Incoming cold snap (Δ -16\xb0F) with advisory issued",supporting_factors:["Search demand for 'lightweight parka' up 41% vs seasonal baseline","Merchandising dashboards show 14 days of stock coverage","Google Smart Bidding historical lift +18% under similar weather anomalies"],confidence_level:"MEDIUM",data_quality:"Weather coverage 96%; Google Ads attribution window overlapping sale period",assumptions:["Courier capacity confirmed for overnight shipping"],risks:["Blizzard severity could delay fulfillment, reducing realized lift"]}},{plan_date:t(3),geo_group_id:"Pacific Northwest",category:"Rainwear \xb7 Commuter",channel:"Email \xb7 Klaviyo",recommended_spend:1100,expected_revenue:{p10:2200,p50:3600,p90:4500},expected_roas:{p10:2,p50:3.27,p90:4.09},confidence:"HIGH",assumptions:["Lifecycle drip campaign ready with weather conditional step"],rationale:{primary_driver:'Atmospheric river event delivering 1.8" rain in Seattle metro',supporting_factors:["Rain-triggered automation historically drives 32% click-to-open lift","SMS follow-up variant already QA’d with compliance team","Merch mix includes new breathable trench inventory"],confidence_level:"HIGH",data_quality:"Email + SMS attribution pipeline verified (92% open tracking coverage)",assumptions:["No deliverability degradation from recent sale blast"],risks:["Must throttle sends if engagement dips below 18% to maintain inbox placement"]}},{plan_date:t(4),geo_group_id:"Florida Peninsula",category:"Travel \xb7 Accessories",channel:"Meta Advantage+",recommended_spend:1500,expected_revenue:{p10:2e3,p50:3200,p90:4300},expected_roas:{p10:1.33,p50:2.13,p90:2.87},confidence:"LOW",assumptions:["Tropical storm watch remains downgraded"],rationale:{primary_driver:"Transient humidity spike with improved beach conditions after storm clears",supporting_factors:["Travel accessories cohort shows propensity shift +12%","Paid social creative refresh scheduled with new summer narrative","Airline bookings trending +7% week-over-week across Miami / Tampa"],confidence_level:"LOW",data_quality:"Weather forecast volatility \xb120%; campaign cohort limited to 180 conversions",assumptions:["Storm center continues moving east; no renewed warnings"],risks:["Rapid weather reversal could nullify demand spike"]}},{plan_date:t(5),geo_group_id:"New York Metro",category:"Essentials \xb7 Rain Gear",channel:"Google Search",recommended_spend:1800,expected_revenue:{p10:2500,p50:3900,p90:5200},expected_roas:{p10:1.39,p50:2.17,p90:2.89},confidence:"MEDIUM",assumptions:["Transit alerts drive commuter prep purchases"],rationale:{primary_driver:"Back-to-back rainfall events with flood advisory",supporting_factors:["Branded umbrella queries already up 33%","Creative set `Storm Ready` flagged green in QA","NY Metro heavy rainfall typically increases AOV 12%"],confidence_level:"MEDIUM",data_quality:"Attribution mix contains 45-day lookback; minimal missing conversions",assumptions:["Logistics team confirms expedited shipping thresholds met"],risks:["Flooding disruptions can impact warehouse dispatch SLAs"]}}];function l(e){let n=s[e.primaryChannel],a=r.map((a,t)=>0===t?{...a,channel:n.channel,rationale:{...a.rationale,primary_driver:n.headline,supporting_factors:n.supporting}}:"meta"===e.primaryChannel&&"Meta Advantage+"===a.channel||"google"===e.primaryChannel&&"Google Search"===a.channel||"email"===e.primaryChannel&&a.channel.includes("Email")?a:"pos"===e.primaryChannel&&a.geo_group_id.includes("Texas")?{...a,channel:"Shopify POS \xb7 Local activation",rationale:{...a.rationale,supporting_factors:["Localized signage kit scheduled for dawn delivery","POS loyalty notifications set to trigger at doors-open","In-store associates briefed on weather-specific offers"]}}:a);return{tenant_id:"demo-tour",generated_at:new Date().toISOString(),horizon_days:7,slices:a,context_tags:["demo","calm-theme","channel:".concat(e.primaryChannel),"automation:".concat(e.automationComfort)],data_context:{metadata:{dataset_rows:{orders:2340,campaigns:58,weather_events:12},weather_source:"open-meteo \xb7 synthetic forecast (demo)"}},context_warnings:[{code:"demo-automation-mode",message:i[e.automationComfort].label,severity:"info",tags:["demo","automation"]},{code:"demo-guardrail-reminder",message:i[e.automationComfort].guardrail,severity:"warning",tags:["demo","guardrail"]}],incrementality_summary:{treatment_mean:3.08,control_mean:2.54,absolute_lift:.54,lift:.212,p_value:.018,conf_low:.18,conf_high:.3,sample_size_treatment:420,sample_size_control:410,generated_at:new Date().toISOString(),is_significant:!0}}}},1253:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return ej}});var t,s,i=a(5893),r=a(1664),l=a.n(r),o=a(7294),c=a(9008),d=a.n(c),p=a(1163),m=a(6142),u=a(5795),h=a(6731),g=a(557),f=a(2570),x=a(8179),v=a.n(x);let _={HIGH:"High",MEDIUM:"Medium",LOW:"Low"},y=e=>{let n=e.filter(e=>e.count>0).map(e=>"".concat(e.count," ").concat(e.level.toLowerCase()," confidence ").concat(1===e.count?"slice":"slices"," (").concat(e.percentage.toFixed(1),"%)"));return n.length?n.join(", "):"No confidence slices available yet"};function j(e){let{segments:n,total:a,className:t}=e;if(0===a)return(0,i.jsx)("p",{className:"".concat(v().empty," ").concat(null!=t?t:"").trim(),children:"Awaiting telemetry"});let s=y(n);return(0,i.jsxs)("div",{className:"".concat(v().container," ").concat(null!=t?t:"").trim(),children:[(0,i.jsx)("div",{className:v().bar,role:"img","aria-label":"Confidence mix: ".concat(s),children:n.map(e=>{let n=Math.max(0,e.percentage);return(0,i.jsx)("span",{className:"".concat(v().segment," ").concat(v()["segment".concat(e.level)]),style:{flexBasis:"".concat(n,"%"),flexGrow:n},children:(0,i.jsxs)("span",{className:v().srOnly,children:[_[e.level]," confidence ",e.count," ",1===e.count?"slice":"slices"," (",e.percentage.toFixed(1),"%)"]})},e.level)})}),(0,i.jsx)("dl",{className:v().legend,children:n.map(e=>(0,i.jsxs)("div",{className:v().legendItem,children:[(0,i.jsx)("dt",{className:v().legendLabel,children:_[e.level]}),(0,i.jsxs)("dd",{className:v().legendValue,children:[e.count," ",1===e.count?"slice":"slices"," \xb7"," ",e.percentage.toFixed(1),"%"]})]},e.level))})]})}var b=a(3526),N=a.n(b);function w(e){return null==e||Number.isNaN(e)?"—":"".concat((100*e).toFixed(1),"%")}function S(e){if(!e)return"—";try{let n=new Date(e);if(Number.isNaN(n.getTime()))return"—";return n.toLocaleString()}catch(e){return"—"}}function k(e){return null==e||Number.isNaN(e)?"—":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e)}function C(e){var n,a;let{lift:t,experiment:s,className:r}=e;if(!t&&!s)return null;let l=t||(null==s?void 0:s.lift),o=null!=l,c=!!l&&!!l.is_significant;return(0,i.jsxs)("div",{className:"".concat(N().card," ds-surface-panel ").concat(null!=r?r:"").trim(),"aria-label":"Lift and confidence metrics",children:[(0,i.jsxs)("div",{className:N().header,children:[(0,i.jsx)("span",{className:"ds-caption",children:"Experiment lift & confidence"}),(0,i.jsx)("span",{className:"ds-badge","data-tone":c?"success":o?"info":"muted",children:c?"Significant":o?"Ready":"Awaiting results"})]}),o&&l&&(0,i.jsxs)("div",{className:N().content,children:[(0,i.jsxs)("div",{className:N().liftSection,children:[(0,i.jsxs)("div",{className:N().heroMetric,children:[(0,i.jsx)("span",{className:"".concat(N().liftValue," ds-metric"),children:null==(n=l.lift_pct)||Number.isNaN(n)?"—":"".concat(n.toFixed(1),"%")}),(0,i.jsx)("span",{className:"ds-caption",children:"Measured lift"})]}),(0,i.jsxs)("div",{className:N().confidenceInterval,children:[(0,i.jsxs)("div",{className:N().interval,children:[(0,i.jsx)("span",{className:N().label,children:"95% confidence band"}),(0,i.jsxs)("div",{className:N().range,children:[(0,i.jsx)("span",{className:N().bound,children:w(l.confidence_low)}),(0,i.jsx)("span",{className:N().dash,children:"–"}),(0,i.jsx)("span",{className:N().bound,children:w(l.confidence_high)})]})]}),(0,i.jsxs)("div",{className:N().significance,children:[(0,i.jsx)("span",{className:N().label,children:"Statistical significance"}),(0,i.jsxs)("span",{className:N().pValue,children:["p = ",null==(a=l.p_value)||Number.isNaN(a)?"—":a<.001?"< 0.001":a.toFixed(3)]}),(0,i.jsx)("span",{className:"".concat(N().verdict," ds-caption"),children:c?"Result is statistically significant at α=0.05":"Result does not meet significance threshold"})]})]})]}),(0,i.jsxs)("dl",{className:N().metrics,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Absolute lift"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return null==e||Number.isNaN(e)?"—":e.toLocaleString(void 0,{minimumFractionDigits:n,maximumFractionDigits:n})}(l.absolute_lift,2)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Sample size"}),(0,i.jsxs)("dd",{className:"ds-body-strong",children:[l.sample_size.toLocaleString()," observations"]})]}),l.generated_at&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Generated"}),(0,i.jsx)("dd",{className:"ds-caption",children:S(l.generated_at)})]})]}),s&&(0,i.jsxs)("div",{className:N().experimentDetails,children:[(0,i.jsx)("h4",{className:"ds-body-strong",children:"Experiment setup"}),(0,i.jsxs)("dl",{className:N().details,children:[s.treatment_geos.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Treatment geos"}),(0,i.jsx)("dd",{className:"ds-body",children:s.treatment_geos.join(", ")})]}),s.control_geos.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Control geos"}),(0,i.jsx)("dd",{className:"ds-body",children:s.control_geos.join(", ")})]}),null!==s.treatment_spend&&void 0!==s.treatment_spend&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Treatment spend"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:k(s.treatment_spend)})]}),null!==s.control_spend&&void 0!==s.control_spend&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Control spend"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:k(s.control_spend)})]}),s.start_date&&(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Window"}),(0,i.jsxs)("dd",{className:"ds-body",children:[S(s.start_date),s.end_date&&(0,i.jsxs)(i.Fragment,{children:[" ","– ",S(s.end_date)]})]})]})]})]})]}),!o&&(0,i.jsx)("div",{className:N().empty,children:(0,i.jsx)("p",{className:"ds-body",children:(null==s?void 0:s.status)==="running"?"Experiment is running. Results will appear here when complete.":"No lift data available yet. Run an experiment to measure weather impact."})})]})}let M=["plan_date","geo_group_id","category","channel","cell","confidence","recommended_spend","expected_revenue_p10","expected_revenue_p50","expected_revenue_p90","expected_roas_p10","expected_roas_p50","expected_roas_p90","primary_driver","supporting_factors","assumptions","risks"],I=["experiment_id","status","metric_name","treatment_geos","control_geos","treatment_spend","control_spend","lift_pct","absolute_lift","confidence_low","confidence_high","p_value","is_significant","sample_size","generated_at"],L=e=>"number"==typeof e&&Number.isFinite(e)?e.toString():"",D=e=>(null!=e?e:[]).map(e=>e.replace(/\s+/g," ").trim()).filter(Boolean).join("; "),A=e=>{if(""===e)return"";if(/[",\n]/.test(e)){let n=e.replace(/"/g,'""');return'"'.concat(n,'"')}return e},H=e=>{var n,a,t;let s=e.expected_roas,i=null!==(n=e.rationale)&&void 0!==n?n:{primary_driver:"",supporting_factors:[],assumptions:[],risks:[]};return[e.plan_date,e.geo_group_id,e.category,e.channel,null!==(a=e.cell)&&void 0!==a?a:"",e.confidence,L(e.recommended_spend),L(e.expected_revenue.p10),L(e.expected_revenue.p50),L(e.expected_revenue.p90),L(null==s?void 0:s.p10),L(null==s?void 0:s.p50),L(null==s?void 0:s.p90),null!==(t=i.primary_driver)&&void 0!==t?t:"",D(i.supporting_factors),D(i.assumptions),D(i.risks)]},F=e=>[M.join(","),...e.slices.map(e=>H(e).map(A).join(","))].join("\n"),O=(e,n)=>{let a=e.replace(/[^a-zA-Z0-9_-]/g,"-")||"tenant",t=(()=>{let e=new Date(n);return Number.isNaN(e.getTime())?"unknown":e.toISOString().replace(/\.\d{3}Z$/,"Z").replace(/:/g,"-")})();return"weathervane-plan-".concat(a,"-").concat(t,".csv")},E=e=>{var n;let a=e.lift;return[e.experiment_id,e.status,e.metric_name,e.treatment_geos.join("; "),e.control_geos.join("; "),L(e.treatment_spend),L(e.control_spend),a?L(100*a.lift_pct):"",a?L(a.absolute_lift):"",a?L(100*a.confidence_low):"",a?L(100*a.confidence_high):"",a?L(a.p_value):"",a?a.is_significant?"true":"false":"",a?a.sample_size.toString():"",null!==(n=null==a?void 0:a.generated_at)&&void 0!==n?n:""]},P=e=>[I.join(","),...e.map(e=>E(e).map(A).join(","))].join("\n"),T=e=>{var n;let a=F(e),t=null!==(n=e.experiments)&&void 0!==n?n:[];if(0===t.length)return a;let s=P(t);return"".concat(a,"\n\n[EXPERIMENTS]\n").concat(s)},B=(e,n)=>{let a=e.replace(/[^a-zA-Z0-9_-]/g,"-")||"tenant",t=(()=>{let e=new Date(n);return Number.isNaN(e.getTime())?"unknown":e.toISOString().replace(/\.\d{3}Z$/,"Z").replace(/:/g,"-")})();return"weathervane-experiments-".concat(a,"-").concat(t,".csv")},R=(e,n)=>{let a=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)};function G(e){let{plan:n,tenantId:a,className:t,analyticsId:s="plan.banner.download",onDownload:r}=e,[l,c]=(0,o.useState)(!1),d=(0,o.useCallback)(()=>{if(!n||!n.slices.length)return;let e=F(n),t=O(a,n.generated_at);r?r(e,t):R(e,t),c(!1)},[n,a,r]),p=(0,o.useCallback)(()=>{if(!n||!n.slices.length)return;let e=T(n),t=O(a,n.generated_at);r?r(e,t):R(e,t),c(!1)},[n,a,r]),m=(0,o.useCallback)(()=>{if(!n||!n.experiments||0===n.experiments.length)return;let e=B(a,n.generated_at),t="experiment_id,status,metric_name,lift_pct,absolute_lift,confidence_low,confidence_high,p_value,is_significant,sample_size,generated_at\n".concat(n.experiments.map(e=>{var n;let a=e.lift;return[e.experiment_id,e.status,e.metric_name,a?(100*a.lift_pct).toFixed(2):"",a?a.absolute_lift.toFixed(2):"",a?(100*a.confidence_low).toFixed(2):"",a?(100*a.confidence_high).toFixed(2):"",a?a.p_value.toFixed(4):"",a?a.is_significant?"true":"false":"",a?a.sample_size:"",null!==(n=null==a?void 0:a.generated_at)&&void 0!==n?n:""].map(e=>e&&"string"==typeof e&&/[",\n]/.test(e)?'"'.concat(e.replace(/"/g,'""'),'"'):e).join(",")}).join("\n"));r?r(t,e):R(t,e),c(!1)},[n,a,r]),u=!n||0===n.slices.length;return n&&n.experiments&&n.experiments.length>0?(0,i.jsxs)("div",{style:{position:"relative",display:"inline-block"},children:[(0,i.jsx)("button",{type:"button",onClick:()=>c(!l),className:t,"data-analytics-id":s,disabled:u,children:"Export plan & experiments →"}),l&&(0,i.jsxs)("div",{style:{position:"absolute",top:"100%",left:0,marginTop:"0.5rem",minWidth:"200px",backgroundColor:"var(--ds-surface-default)",border:"1px solid var(--ds-border-subtle)",borderRadius:"0.375rem",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:10},children:[(0,i.jsx)("button",{type:"button",onClick:d,style:{display:"block",width:"100%",padding:"0.75rem 1rem",textAlign:"left",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"0.875rem"},"data-analytics-id":"".concat(s,".plan"),children:"Plan only"}),(0,i.jsx)("button",{type:"button",onClick:p,style:{display:"block",width:"100%",padding:"0.75rem 1rem",textAlign:"left",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"0.875rem",borderTop:"1px solid var(--ds-border-subtle)"},"data-analytics-id":"".concat(s,".combined"),children:"Plan with experiments"}),(0,i.jsx)("button",{type:"button",onClick:m,style:{display:"block",width:"100%",padding:"0.75rem 1rem",textAlign:"left",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"0.875rem",borderTop:"1px solid var(--ds-border-subtle)"},"data-analytics-id":"".concat(s,".experiments"),children:"Experiments only"})]})]}):(0,i.jsx)("button",{type:"button",onClick:d,className:t,"data-analytics-id":s,disabled:u,children:"Export plan CSV"})}var W=a(9605),U=a(918),z=a(218),V=a.n(z),Z=a(6091),q=a(1853),K=a(1162),X=a(742),Y=a(1916);let J=["HIGH","MEDIUM","LOW"],Q=e=>"".concat(e.plan_date,"::").concat(e.geo_group_id,"::").concat(e.channel),$=(e,n)=>Number.isFinite(e)&&Number.isFinite(n)&&0!==n?e/n:null,ee=e=>null===e||Number.isNaN(e)?null:e<0?0:e>100?100:e,en=e=>{var n,a,t,s;return(null===(n=e.rationale)||void 0===n?void 0:n.primary_driver)?e.rationale.primary_driver:null!==(s=(null!==(t=null===(a=e.rationale)||void 0===a?void 0:a.supporting_factors)&&void 0!==t?t:[])[0])&&void 0!==s?s:"Weather-driven opportunity"},ea=e=>{var n,a,t,s,i,r,l;let o=null!==(t=null===(n=e.rationale)||void 0===n?void 0:n.risks)&&void 0!==t?t:[],c=null!==(s=null===(a=e.rationale)||void 0===a?void 0:a.assumptions)&&void 0!==s?s:[];return null!==(l=null!==(r=null!==(i=e.assumptions[0])&&void 0!==i?i:o[0])&&void 0!==r?r:c[0])&&void 0!==l?l:"Guardrail anomaly flagged for operator review."},et=e=>{var n;if(!e.length)return{roiMultiple:null,roiDeltaPct:null,liftAmount:null,guardrailConfidencePct:null,topDriver:null};let a=e.reduce((e,n)=>e+n.recommended_spend,0),t=e.reduce((e,n)=>e+n.expected_revenue.p50,0),s=$(t,a),i=$(t-a,a),r=Number.isFinite(t)&&Number.isFinite(a)?t-a:null,l=e.reduce((e,n)=>(e[n.confidence]+=1,e),{HIGH:0,MEDIUM:0,LOW:0}),o=l.HIGH+l.MEDIUM+l.LOW,c=$(l.HIGH+.5*l.MEDIUM,o);return{roiMultiple:s,roiDeltaPct:null===i?null:100*i,liftAmount:r,guardrailConfidencePct:null===c?null:ee(100*c),topDriver:null!==(n=[...e].sort((e,n)=>n.expected_revenue.p50-e.expected_revenue.p50).map(e=>en(e))[0])&&void 0!==n?n:null}},es=e=>Number.isFinite(e)?Math.max(0,Math.min(100,Math.round(10*e)/10)):0,ei=e=>{let n={HIGH:0,MEDIUM:0,LOW:0};e.forEach(e=>{n[e.confidence]+=1});let a=n.HIGH+n.MEDIUM+n.LOW,t=J.map(e=>{let t=n[e],s=0===a?0:es(t/a*100);return{level:e,count:t,percentage:s}});return{total:a,counts:n,segments:t}},er=e=>{var n,a,t,s,i;if(!e.length)return[];let r=[...e].sort((e,n)=>n.expected_revenue.p50-e.expected_revenue.p50),l=null!==(n=r[0])&&void 0!==n?n:null,o=null!==(t=null!==(a=r.find(e=>e!==l&&"LOW"!==e.confidence))&&void 0!==a?a:r[1])&&void 0!==t?t:null,c=null!==(i=null!==(s=r.find(e=>"LOW"===e.confidence))&&void 0!==s?s:r[r.length-1])&&void 0!==i?i:null,d=[];return l&&d.push({kind:"primary",slice:l,reason:en(l),analyticsId:"plan.card.approve"}),o&&!d.some(e=>Q(e.slice)===Q(o))&&d.push({kind:"followUp",slice:o,reason:en(o),analyticsId:"plan.card.follow_up"}),c&&!d.some(e=>Q(e.slice)===Q(c))&&d.push({kind:"risk",slice:c,reason:ea(c),analyticsId:"plan.card.risk"}),d};var el=a(5777),eo=a(3454);let ec=null!==(t=eo.env.NEXT_PUBLIC_TENANT_ID)&&void 0!==t?t:"demo-tenant",ed=Number(null!==(s=eo.env.NEXT_PUBLIC_PLAN_HORIZON)&&void 0!==s?s:"7"),ep="wvo-plan-persona-mode",em=[{id:"demo",label:"Demo",description:"Guided tour with seeded insights",analyticsId:"plan.mode.demo"},{id:"assist",label:"Assist",description:"Operators approve weather moves",analyticsId:"plan.mode.assist"},{id:"automation",label:"Automation",description:"Guardrails execute autonomously",analyticsId:"plan.mode.automation"}],eu={demo:{title:"Graduate from the demo",body:"Connect Shopify, Meta, and Google Ads to swap seeded cards for live telemetry. Sarah will see the real ROI strip once connectors finish syncing.",ctaLabel:"Open setup bridge",href:"/setup",analyticsId:"plan.prompt.demo_setup"},assist:{title:"Review today’s diff drawer",body:"Approve or adjust the primary automation so the automated engine can inherit your guardrail decisions. Record rationale for Sarah in Stories.",ctaLabel:"Jump to Automations",href:"/automations?source=plan",analyticsId:"plan.prompt.assist_automations"},automation:{title:"Monitor WeatherOps uptime",body:"Keep an eye on guardrail health and connector latency. Any sustained anomaly will pause automated pushes until an operator acknowledges it.",ctaLabel:"Open WeatherOps dashboard",href:"/dashboard?source=plan",analyticsId:"plan.prompt.automation_dashboard"}},eh=[{id:"base",label:"Base outlook",description:"Blended forecast using live telemetry",multiplier:1,analyticsId:"plan.scenario.base"},{id:"warm",label:"Warm surge",description:"Hot front boosts demand by ~8%",multiplier:1.08,analyticsId:"plan.scenario.warm"},{id:"storm",label:"Storm watch",description:"Severe weather dampens spend by ~12%",multiplier:.88,analyticsId:"plan.scenario.storm"}],eg=["HIGH","MEDIUM","LOW"],ef={primary:"Primary action",followUp:"Follow-up",risk:"Risk alert"},ex={primary:{href:"/automations?source=plan&view=diff",label:"Review diff drawer",helper:"Approve to ship the highest-leverage automation."},followUp:{href:"/stories?source=plan",label:"Open Stories",helper:"Share context with Sarah so the team stays aligned."},risk:{href:"/dashboard?tab=guardrails&source=plan",label:"Acknowledge guardrail",helper:"Resolve the alert so automation can resume confidently."}};function ev(e){if("number"!=typeof e||!Number.isFinite(e))return"—";let n=Math.abs(e)>=1e3?0:2;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:n}).format(e)}function e_(e){if(!Number.isFinite(e)||0===e)return"\xb1$0";let n=ev(Math.abs(e));return e>0?"+".concat(n):"-".concat(n)}function ey(e){return"number"==typeof e&&Number.isFinite(e)?"".concat(e.toFixed(2),"\xd7"):"—"}function ej(){var e,n,a,t,s,r,c,x,v,_,y,b,N,w,S,k,M,I,L;let[D,A]=(0,o.useState)(null),[H,F]=(0,o.useState)(!0),[O,E]=(0,o.useState)(null),[P,T]=(0,o.useState)(0),[B,R]=(0,o.useState)("base"),z=(0,p.useRouter)(),{theme:J}=(0,Y.F)(),Q=(0,o.useMemo)(()=>(0,el.W)(J,"plan"),[J]),{isDemoActive:$,preferences:ee,activateDemo:ea,resetDemo:es,setPreferences:eo}=(0,q.F)(),ej=z.query.demo,eb=Array.isArray(ej)?ej[0]:ej,eN=z.isReady&&void 0!==eb&&"0"!==eb&&"false"!==eb,ew=$||eN,eS="automation"===ee.automationComfort?"automation":"assist",[ek,eC]=(0,o.useState)($?"demo":eS);(0,o.useEffect)(()=>{let e=window.localStorage.getItem(ep);("demo"===e||"assist"===e||"automation"===e)&&eC(e)},[]),(0,o.useEffect)(()=>{if($){eC("demo");return}eC(e=>"demo"===e?"automation"===ee.automationComfort?"automation":"assist":e)},[$,ee.automationComfort]),(0,o.useEffect)(()=>{window.localStorage.setItem(ep,ek)},[ek]);let eM=(0,X.v)({tenantId:ec,mode:ew?"demo":"live"}),eI=eM.connectors,eL=eM.audits,eD=(0,o.useMemo)(()=>eI.filter(e=>"ready"===e.status).length,[eI]),eA=(0,o.useMemo)(()=>{let e=["".concat(eD," of ").concat(eI.length," connected")];if(eM.loading)e.push("syncing…");else{var n,a;let t=function(e){if(!e)return null;let n=new Date(e);return Number.isNaN(n.getTime())?null:n.toLocaleString()}(null!==(a=null===(n=eM.snapshot)||void 0===n?void 0:n.generated_at)&&void 0!==a?a:null);t&&e.push("updated ".concat(t))}return eM.isFallback&&e.push("demo snapshot"),e.join(" \xb7 ")},[eM.loading,null===(e=eM.snapshot)||void 0===e?void 0:e.generated_at,eM.isFallback,eI,eD]),eH=null!==(x=null===(n=eM.error)||void 0===n?void 0:n.message)&&void 0!==x?x:null,eF=(0,o.useCallback)(()=>{let e=!0;return F(!0),(0,Z.Eo)(ec,ed).then(n=>{e&&(A(n),E(null))}).catch(n=>{var a;e&&E(null!==(a=n.message)&&void 0!==a?a:"We ran into an issue loading the latest plan.")}).finally(()=>{e&&F(!1)}),()=>{e=!1}},[]);(0,o.useEffect)(()=>{eN&&!$&&ea()},[eN,$,ea]),(0,o.useEffect)(()=>{if(ew){A((0,K.Y)(ee)),E(null),F(!1);return}return eF()},[ew,ee,eF,P]);let eO=(0,o.useCallback)(e=>{if(e===ek)return;if(eC(e),window.localStorage.setItem(ep,e),"demo"===e){$||ea(),z.replace({pathname:z.pathname,query:{...z.query,demo:"1"}},void 0,{shallow:!0});return}$&&es();let n="automation"===e?"automation":"assist";ee.automationComfort!==n&&eo({...ee,automationComfort:n});let a={...z.query};"demo"in a&&(delete a.demo,z.replace({pathname:z.pathname,query:a},void 0,{shallow:!0}))},[ea,$,ek,ee,es,z,eo]),eE=null==D?void 0:D.slices,eP=(0,o.useMemo)(()=>null!=eE?eE:[],[eE]),eT=(0,o.useMemo)(()=>eP.length?eP.map(e=>{var n,a;let t=null!==(a=null===(n=e.expected_roas)||void 0===n?void 0:n.p50)&&void 0!==a?a:null;return{key:"".concat(e.plan_date,"-").concat(e.geo_group_id,"-").concat(e.channel),date:function(e){let n=new Date(e);return Number.isNaN(n.getTime())?e:n.toLocaleDateString(void 0,{month:"short",day:"numeric"})}(e.plan_date),geo:e.geo_group_id,category:e.category,channel:e.channel,spend:ev(e.recommended_spend),revenueP50:ev(e.expected_revenue.p50),roasP50:ey(t),confidence:e.confidence,driver:en(e)}}):[],[eP]),eB=(0,o.useMemo)(()=>eP.length?ev(eP.reduce((e,n)=>e+n.recommended_spend,0)):"—",[eP]),eR=(0,o.useMemo)(()=>eP.length?ev(eP.reduce((e,n)=>e+n.expected_revenue.p50,0)):"—",[eP]),eG=(0,o.useMemo)(()=>eP.length?new Set(eP.map(e=>e.geo_group_id)).size:0,[eP]),eW=(0,o.useMemo)(()=>eP.length?function(e){if(!e.length)return"—";let n=[...e].sort((e,n)=>new Date(e).getTime()-new Date(n).getTime()),a=new Date(n[0]),t=new Date(n[n.length-1]);if(Number.isNaN(a.getTime())||Number.isNaN(t.getTime()))return"—";let s=a.toLocaleDateString(void 0,{month:"short",day:"numeric"}),i=t.toLocaleDateString(void 0,{month:"short",day:"numeric"});return s===i?s:"".concat(s," – ").concat(i)}(eP.map(e=>e.plan_date)):"—",[eP]),eU=(0,o.useMemo)(()=>ei(eP),[eP]),ez=eU.counts,eV=eU.total,eZ=eU.segments,eq=(0,o.useMemo)(()=>{if(!eP.length)return[];let e=new Map;return eP.forEach(n=>{var a;let t=null!==(a=e.get(n.plan_date))&&void 0!==a?a:{dateKey:n.plan_date,label:function(e){let n=new Date(e);return Number.isNaN(n.getTime())?e:n.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}(n.plan_date),spend:0,topDriver:en(n),topConfidence:n.confidence,counts:{HIGH:0,MEDIUM:0,LOW:0}},s=t.spend;t.spend+=n.recommended_spend,t.counts[n.confidence]+=1;let i=t.topConfidence?eg.indexOf(t.topConfidence):Number.POSITIVE_INFINITY,r=eg.indexOf(n.confidence);(n.recommended_spend>s||r<i)&&(t.topDriver=en(n),t.topConfidence=n.confidence),e.set(n.plan_date,t)}),[...e.values()].sort((e,n)=>new Date(e.dateKey).getTime()-new Date(n.dateKey).getTime())},[eP]),eK=(0,o.useMemo)(()=>{var e;return null!==(e=eh.find(e=>e.id===B))&&void 0!==e?e:eh[0]},[B]),eX=(0,o.useMemo)(()=>eq.length?eq.map(e=>({...e,scenarioSpend:e.spend*eK.multiplier,scenarioDelta:e.spend*(eK.multiplier-1)})):[],[eq,eK]),eY=(null==D?void 0:D.generated_at)?new Date(D.generated_at).toLocaleString():"—",eJ=null!==(v=null==D?void 0:D.context_tags)&&void 0!==v?v:[],eQ=null!==(_=null==D?void 0:D.context_warnings)&&void 0!==_?_:[],e$=null!==(y=null==D?void 0:null===(t=D.data_context)||void 0===t?void 0:null===(a=t.metadata)||void 0===a?void 0:a.dataset_rows)&&void 0!==y?y:{},e0=null!==(b=null==D?void 0:null===(r=D.data_context)||void 0===r?void 0:null===(s=r.metadata)||void 0===s?void 0:s.weather_source)&&void 0!==b?b:"unknown",e1=(0,o.useMemo)(()=>er(eP),[eP]),e5=(0,o.useMemo)(()=>et(eP),[eP]),e2=eu[ek],e9=null===e5.roiMultiple?"—":"".concat(e5.roiMultiple.toFixed(2),"\xd7"),e3=null===e5.roiDeltaPct?"Awaiting telemetry":"".concat(e5.roiDeltaPct>=0?"+":"").concat(e5.roiDeltaPct.toFixed(e5.roiDeltaPct>=10?0:1),"% vs spend"),e4=null===e5.liftAmount?"—":e_(e5.liftAmount),e8=null===e5.liftAmount?"Awaiting telemetry":"Incremental revenue vs spend",e7=null===(L=e5.guardrailConfidencePct)||Number.isNaN(L)?"—":"".concat(Math.round(L),"%"),e6=null===e5.guardrailConfidencePct?0:Math.min(100,Math.max(0,e5.guardrailConfidencePct)),ne=null!==(N=e5.topDriver)&&void 0!==N?N:"We will highlight the dominant weather driver as soon as telemetry lands.",nn=!H&&!O&&eP.length>0,na=!H&&!O;return(0,i.jsxs)(f.A,{children:[(0,i.jsx)(d(),{children:(0,i.jsx)("title",{children:"WeatherVane \xb7 Plan"})}),(0,i.jsxs)("div",{className:V().root,style:Q,children:[(0,i.jsx)(g.W,{message:"Predictions reflect historical correlations; causal lift remains under validation until Phase 4 completes."}),(0,i.jsxs)("header",{className:V().hero,children:[(0,i.jsxs)("div",{className:V().heroStrip,"data-analytics-id":"plan.hero",children:[(0,i.jsx)("p",{className:"".concat(V().pageEyebrow," ds-eyebrow ds-eyebrow-neutral"),children:"This week’s weather-aware plan"}),(0,i.jsx)("h2",{className:"".concat(V().pageTitle," ds-title"),children:"Operator command center"}),(0,i.jsx)("p",{className:"".concat(V().pageSubtitle," ds-subtitle"),children:"Prioritise the highest-leverage weather opportunities, quantify guardrail impact, and align Sarah and Leo on what happens next."}),ew&&(0,i.jsxs)("div",{className:V().demoBanner,children:[(0,i.jsx)("span",{className:V().demoBadge,children:"Demo mode"}),(0,i.jsxs)("p",{children:["This preview is seeded with sample data based on your tour answers."," ",(0,i.jsx)(l(),{href:"/setup",className:V().demoLink,"data-analytics-id":"plan.demo.setup",children:"Open the setup bridge"})," ","to connect live systems and graduate into assist or automation mode."]})]}),(0,i.jsxs)("dl",{className:V().heroMetrics,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"ROI multiple"}),(0,i.jsxs)("dd",{children:[(0,i.jsx)("span",{className:V().metricValue,children:e9}),(0,i.jsx)("span",{className:V().metricHint,children:e3})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Projected lift (p50)"}),(0,i.jsxs)("dd",{children:[(0,i.jsx)("span",{className:V().metricValue,children:e4}),(0,i.jsx)("span",{className:V().metricHint,children:e8})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Guardrail confidence"}),(0,i.jsxs)("dd",{children:[(0,i.jsx)("span",{className:V().metricValue,children:e7}),(0,i.jsx)("span",{className:V().guardrailMeter,"aria-hidden":"true",children:(0,i.jsx)("span",{className:V().guardrailMeterFill,style:{width:"".concat(e6,"%")}})}),(0,i.jsx)(j,{segments:eZ,total:eV,className:V().heroConfidenceMix})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Weather synopsis"}),(0,i.jsx)("dd",{children:(0,i.jsx)("span",{className:V().metricValue,children:ne})})]})]}),(0,i.jsxs)("div",{className:V().summaryFacts,children:[(0,i.jsxs)("dl",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Plan window"}),(0,i.jsx)("dd",{children:eW})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Total recommended spend"}),(0,i.jsx)("dd",{children:eB})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Projected revenue (p50)"}),(0,i.jsx)("dd",{children:eR})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Geographies covered"}),(0,i.jsx)("dd",{children:eG||"—"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Generated"}),(0,i.jsx)("dd",{children:eY})]})]}),nn&&(0,i.jsxs)("div",{className:V().heroActions,children:[(0,i.jsxs)("div",{className:V().heroAction,children:[(0,i.jsx)(l(),{href:"/reports?source=plan",className:V().heroShareCta,"data-analytics-id":"plan.banner.share",children:"Open executive report →"}),(0,i.jsx)("p",{className:V().heroActionsHint,children:"Share this week’s ROI storyline with Sarah ahead of the exec review."})]}),(0,i.jsxs)("div",{className:V().heroAction,children:[(0,i.jsx)(G,{plan:D,tenantId:ec,className:V().heroShareCta}),(0,i.jsx)("p",{className:V().heroActionsHint,children:"Export the full recommendation set to audit lift and guardrails offline."})]})]})]})]}),(0,i.jsx)("div",{className:V().modeSwitch,role:"radiogroup","aria-label":"Plan persona view",children:em.map(e=>{let n=e.id===ek;return(0,i.jsxs)("button",{type:"button",className:"".concat(V().modeButton," ").concat(n?V().modeButtonActive:""),onClick:()=>eO(e.id),"data-analytics-id":e.analyticsId,"aria-pressed":n,children:[(0,i.jsx)("span",{className:V().modeLabel,children:e.label}),(0,i.jsx)("span",{className:V().modeDescription,children:e.description})]},e.id)})})]}),H&&(0,i.jsxs)("section",{className:V().loadingSection,"aria-live":"polite",children:[(0,i.jsx)("p",{className:V().loadingMessage,children:"Stitching weather signals into your plan…"}),(0,i.jsx)("div",{className:V().skeletonRow}),(0,i.jsxs)("div",{className:V().skeletonGrid,children:[(0,i.jsx)("div",{className:V().skeletonCard}),(0,i.jsx)("div",{className:V().skeletonCard}),(0,i.jsx)("div",{className:V().skeletonCard})]})]}),O&&(0,i.jsxs)("div",{className:V().error,role:"alert",children:[(0,i.jsx)("h3",{className:V().errorTitle,children:"We couldn’t load your plan"}),(0,i.jsx)("p",{children:O}),(0,i.jsx)("p",{className:V().errorHelper,children:"This usually resolves within a few seconds. You can retry now or check the worker logs for pipeline status."}),(0,i.jsx)("div",{className:V().errorActions,children:(0,i.jsx)(U.P,{onClick:()=>T(e=>e+1),children:"Try again"})})]}),na&&(0,i.jsxs)("div",{className:V().planBody,children:[(0,i.jsxs)("div",{className:V().primaryColumn,children:[(0,i.jsxs)("section",{className:V().opportunitiesSection,"aria-label":"Opportunity queue",children:[(0,i.jsxs)("div",{className:V().sectionHeader,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Opportunity queue"}),(0,i.jsx)("p",{className:"ds-caption",children:"Approve, adjust, or route the highest-impact weather-driven actions."})]}),(0,i.jsxs)("div",{className:V().opportunityGrid,children:[e1.map(e=>{var n,a;let t=ex[e.kind],s="".concat(e.slice.plan_date,"-").concat(e.slice.geo_group_id,"-").concat(e.slice.channel,"-").concat(e.kind),r="risk"===e.kind?V().opportunityRisk:"followUp"===e.kind?V().opportunityFollow:V().opportunityPrimary;return(0,i.jsxs)("article",{className:"".concat(V().opportunityCard," ").concat(r),"data-kind":e.kind,children:[(0,i.jsxs)("header",{className:V().opportunityHeader,children:[(0,i.jsx)("span",{className:"".concat(V().opportunityKind," ds-caption"),children:ef[e.kind]}),(0,i.jsx)("span",{className:"".concat(V().badge," ").concat(V()["confidence".concat(e.slice.confidence)]),"aria-label":"Confidence ".concat(e.slice.confidence.toLowerCase()),children:e.slice.confidence.toLowerCase()})]}),(0,i.jsx)("h4",{className:"".concat(V().opportunityTitle," ds-title"),children:e.slice.geo_group_id}),(0,i.jsx)("p",{className:"".concat(V().opportunityDriver," ds-body"),children:e.reason}),(0,i.jsxs)("dl",{className:V().opportunityMetrics,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Recommended spend"}),(0,i.jsx)("dd",{children:ev(e.slice.recommended_spend)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Projected revenue (p50)"}),(0,i.jsx)("dd",{children:ev(e.slice.expected_revenue.p50)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:"Projected ROAS (p50)"}),(0,i.jsx)("dd",{children:ey(null!==(a=null===(n=e.slice.expected_roas)||void 0===n?void 0:n.p50)&&void 0!==a?a:null)})]})]}),(0,i.jsxs)("div",{className:V().opportunityActions,children:[(0,i.jsxs)(l(),{href:t.href,className:V().opportunityLink,"data-analytics-id":e.analyticsId,children:[t.label," →"]}),(0,i.jsx)("span",{className:V().opportunityHelper,children:t.helper})]})]},s)}),!e1.length&&(0,i.jsx)("p",{className:V().opportunityEmpty,children:"We’ll surface the largest opportunities here as soon as recommendations are available."})]})]}),(0,i.jsxs)("section",{className:V().dailySection,"aria-label":"Seven-day outlook",children:[(0,i.jsxs)("div",{className:V().sectionHeader,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Seven-day outlook"}),(0,i.jsx)("p",{className:"ds-caption",children:"Preview how spend shifts across the horizon and explore alternative weather scenarios."})]}),(0,i.jsx)("div",{className:V().scenarioSwitch,role:"radiogroup","aria-label":"Scenario",children:eh.map(e=>{let n=e.id===eK.id;return(0,i.jsxs)("button",{type:"button",className:"".concat(V().scenarioButton," ").concat(n?V().scenarioActive:""),onClick:()=>R(e.id),"data-analytics-id":e.analyticsId,"aria-pressed":n,children:[(0,i.jsx)("span",{className:V().scenarioLabel,children:e.label}),(0,i.jsx)("span",{className:V().scenarioDescription,children:e.description})]},e.id)})}),(0,i.jsxs)("p",{className:V().scenarioFootnote,children:["Scenario effect applied: ",eK.description.toLowerCase(),"."]}),(0,i.jsxs)("div",{className:V().scenarioBuilderCta,children:[(0,i.jsx)(l(),{href:"/scenarios",className:V().scenarioBuilderLink,children:"Open advanced scenario builder →"}),(0,i.jsx)("span",{className:"ds-caption",children:"Tune channel-level assumptions and export what-if briefs for Sarah and Priya."})]}),(0,i.jsx)("div",{className:V().dayGrid,children:eX.map(e=>(0,i.jsxs)("article",{className:V().dayCard,children:[(0,i.jsxs)("header",{className:V().dayHeader,children:[(0,i.jsx)("span",{className:"ds-caption",children:e.label}),(0,i.jsxs)("div",{className:V().daySpendGroup,children:[(0,i.jsx)("span",{className:V().daySpendBase,children:ev(e.spend)}),(0,i.jsxs)("span",{className:V().daySpendScenario,children:[ev(e.scenarioSpend),(0,i.jsx)("span",{className:V().daySpendDelta,children:e_(e.scenarioDelta)})]})]})]}),(0,i.jsx)("p",{className:"".concat(V().dayDriver," ds-body"),children:e.topDriver}),(0,i.jsx)("div",{className:V().dayConfidence,children:eg.map(n=>{let a=e.counts[n];return a?(0,i.jsxs)("span",{className:"".concat(V().badge," ").concat(V()["confidence".concat(n)]),"aria-label":"".concat(a," ").concat(n.toLowerCase()," confidence recommendation").concat(a>1?"s":""),children:[n.toLowerCase()," \xb7 ",a]},n):null})})]},e.dateKey))})]}),(0,i.jsx)("section",{className:V().insightsSection,"aria-label":"Confidence insights",children:(0,i.jsxs)("div",{className:V().insightsGrid,children:[(0,i.jsxs)("div",{className:V().insightTile,children:[(0,i.jsxs)("h4",{className:"ds-title",children:[eV?Math.round(ez.HIGH/eV*100):0,"% high confidence"]}),(0,i.jsxs)("p",{className:"ds-body",children:[ez.HIGH," slices are backed by deep historical coverage and stable causal drivers."]})]}),(0,i.jsxs)("div",{className:V().insightTile,children:[(0,i.jsxs)("h4",{className:"ds-title",children:[ez.MEDIUM," medium-confidence slices"]}),(0,i.jsx)("p",{className:"ds-body",children:"These merit manual review. We highlight supporting factors inside the detailed table."})]}),(0,i.jsxs)("div",{className:V().insightTile,children:[(0,i.jsxs)("h4",{className:"ds-title",children:[ez.LOW," exploratory bets"]}),(0,i.jsx)("p",{className:"ds-body",children:"Low-confidence rows tend to coincide with novel campaigns or sparse weather history—treat as optional tests."})]})]})})]}),(0,i.jsxs)("aside",{className:V().secondaryColumn,children:[(0,i.jsxs)("section",{className:V().connectorSection,children:[(0,i.jsxs)("div",{className:V().sectionHeader,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Connector tracker"}),(0,i.jsx)("p",{className:"ds-caption",children:"Keep ingestion healthy so WeatherOps can maintain automation guardrails."})]}),(0,i.jsx)(W.B,{connectors:eI,metaLabel:eA,loading:eM.loading,isFallback:eM.isFallback,errorMessage:eH,className:V().connectorList}),(0,i.jsxs)("div",{className:V().personaPrompt,children:[(0,i.jsx)("h4",{children:e2.title}),(0,i.jsx)("p",{children:e2.body}),(0,i.jsxs)(l(),{href:e2.href,className:V().personaCta,"data-analytics-id":e2.analyticsId,children:[e2.ctaLabel," →"]})]})]}),(0,i.jsxs)("section",{className:V().activitySection,"aria-label":"Activity rail",children:[(0,i.jsxs)("div",{className:V().sectionHeader,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Activity rail"}),(0,i.jsx)("p",{className:"ds-caption",children:"Live feed of automation pushes, approvals, and annotations."})]}),(0,i.jsx)(m.P,{audits:eL,loading:eM.loading,isFallback:eM.isFallback,errorMessage:eH,limit:4,className:V().activityList})]})]})]}),na&&(0,i.jsxs)("section",{className:V().contextLayout,children:[(0,i.jsx)(u.O,{tags:eJ,warnings:eQ}),(0,i.jsx)(h.L,{design:null!==(w=null==D?void 0:D.incrementality_design)&&void 0!==w?w:null,summary:null!==(S=null==D?void 0:D.incrementality_summary)&&void 0!==S?S:null}),(0,i.jsx)(C,{lift:null!==(k=null==D?void 0:D.lift_summary)&&void 0!==k?k:null,experiment:null!==(M=null==D?void 0:null===(c=D.experiments)||void 0===c?void 0:c[0])&&void 0!==M?M:null}),(0,i.jsxs)("div",{className:V().contextMeta,children:[(0,i.jsxs)("div",{className:V().metaRow,children:[(0,i.jsx)("span",{className:V().metaLabel,children:"Weather source"}),(0,i.jsx)("span",{className:V().metaValue,children:e0})]}),Object.keys(e$).length>0&&(0,i.jsx)("dl",{className:V().datasetStats,children:Object.entries(e$).map(e=>{let[n,a]=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{children:n}),(0,i.jsx)("dd",{children:"number"==typeof a?a.toLocaleString():String(null!=a?a:"—")})]},n)})})]})]}),na&&(0,i.jsx)("section",{className:V().tableSection,id:"plan-details",children:(0,i.jsxs)("details",{open:!0,className:V().detailWrapper,children:[(0,i.jsxs)("summary",{className:V().detailSummary,children:["Full allocation table",(0,i.jsx)("span",{className:V().detailHint,children:"Filter by geo, category, or confidence to inspect individual recommendations."})]}),(0,i.jsx)("div",{className:V().tableWrap,children:(0,i.jsxs)("table",{children:[(0,i.jsxs)("caption",{className:"sr-only",children:["Budget allocation recommendations for the next"," ",null!==(I=null==D?void 0:D.horizon_days)&&void 0!==I?I:ed," days, including geography, category, channel, spend, expected revenue, and confidence signals."]}),(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Date"}),(0,i.jsx)("th",{scope:"col",children:"Geo Group"}),(0,i.jsx)("th",{scope:"col",children:"Category"}),(0,i.jsx)("th",{scope:"col",children:"Channel"}),(0,i.jsx)("th",{scope:"col",children:"Spend"}),(0,i.jsx)("th",{scope:"col",children:"Projected revenue (p50)"}),(0,i.jsx)("th",{scope:"col",children:"Projected ROAS (p50)"}),(0,i.jsx)("th",{scope:"col",children:"Confidence"}),(0,i.jsx)("th",{scope:"col",children:"Driver"})]})}),(0,i.jsxs)("tbody",{children:[eT.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.date}),(0,i.jsx)("td",{children:e.geo}),(0,i.jsx)("td",{children:e.category}),(0,i.jsx)("td",{children:e.channel}),(0,i.jsx)("td",{children:e.spend}),(0,i.jsx)("td",{children:e.revenueP50}),(0,i.jsx)("td",{children:e.roasP50}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"".concat(V().badge," ").concat(V()["confidence".concat(e.confidence)]),"aria-label":"Confidence ".concat(e.confidence.toLowerCase()),children:e.confidence.toLowerCase()})}),(0,i.jsx)("td",{children:e.driver})]},e.key)),!eT.length&&(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:9,className:V().emptyState,children:(0,i.jsxs)("div",{className:V().emptyStateWrap,children:[(0,i.jsx)("h4",{children:"Connect your systems to unlock live weather planning"}),(0,i.jsx)("p",{children:"Recommendations appear as soon as the ingestion run finishes. Track connector progress and automation proof points below so the plan matches what you saw in the demo tour."}),(0,i.jsxs)("div",{className:V().emptyPanels,children:[(0,i.jsx)(W.B,{connectors:eI,metaLabel:eA,loading:eM.loading,isFallback:eM.isFallback,errorMessage:eH,className:V().emptyConnectorPanel}),(0,i.jsx)(m.P,{audits:eL,loading:eM.loading,isFallback:eM.isFallback,errorMessage:eH,limit:3,className:V().emptyAuditPanel})]}),(0,i.jsxs)("ul",{className:V().emptyChecklist,children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(l(),{href:"/setup",className:V().emptyLink,children:"Use the setup bridge"})," ","to connect Shopify, Meta, Google Ads, and Klaviyo credentials."]}),(0,i.jsx)("li",{children:"Run the worker pipeline or schedule nightly automation"}),(0,i.jsx)("li",{children:"Return here as soon as the first run completes (we’ll email you)"})]})]})})})]})]})})]})})]})]})}},8179:function(e){e.exports={container:"confidence-mix-bar_container__SMTBo",bar:"confidence-mix-bar_bar__TZbax",segment:"confidence-mix-bar_segment__SB797",segmentHIGH:"confidence-mix-bar_segmentHIGH__I_p_x",segmentMEDIUM:"confidence-mix-bar_segmentMEDIUM__1RXzK",segmentLOW:"confidence-mix-bar_segmentLOW__hWO_U",legend:"confidence-mix-bar_legend__omBZ_",legendItem:"confidence-mix-bar_legendItem__ZsH7Z",legendLabel:"confidence-mix-bar_legendLabel__0vhM8",legendValue:"confidence-mix-bar_legendValue__LebZv",empty:"confidence-mix-bar_empty__kI1U4",srOnly:"confidence-mix-bar_srOnly__9Eod9"}},3526:function(e){e.exports={card:"lift-confidence-card_card__NSEXP",header:"lift-confidence-card_header__m4d3n",content:"lift-confidence-card_content__hTeRL",liftSection:"lift-confidence-card_liftSection__0EgK8",heroMetric:"lift-confidence-card_heroMetric__iGsbU",liftValue:"lift-confidence-card_liftValue__wyEoj",confidenceInterval:"lift-confidence-card_confidenceInterval__HHIf8",interval:"lift-confidence-card_interval__CtZQ9",significance:"lift-confidence-card_significance__FnID_",label:"lift-confidence-card_label__lOdB_",range:"lift-confidence-card_range__9HE5K",bound:"lift-confidence-card_bound__rvIcl",dash:"lift-confidence-card_dash__KhRUA",pValue:"lift-confidence-card_pValue__543GL",verdict:"lift-confidence-card_verdict__JXNDS",metrics:"lift-confidence-card_metrics__z4_Ip",experimentDetails:"lift-confidence-card_experimentDetails__y3mlN",details:"lift-confidence-card_details__7Kahq",empty:"lift-confidence-card_empty__3AyOw"}},4221:function(e){e.exports={container:"onboarding-connector-list_container__D45P9",header:"onboarding-connector-list_header__dHmiD",titleRow:"onboarding-connector-list_titleRow__SeyG0",meta:"onboarding-connector-list_meta__h4ZQl",metaBadges:"onboarding-connector-list_metaBadges__09CTM",badge:"onboarding-connector-list_badge__ie64M",notice:"onboarding-connector-list_notice__ELhhr",list:"onboarding-connector-list_list__CukJZ",item:"onboarding-connector-list_item__Bsdez",itemHeader:"onboarding-connector-list_itemHeader__QaPwA",statusBadge:"onboarding-connector-list_statusBadge__Y72RU",summary:"onboarding-connector-list_summary__RvZey",progressRow:"onboarding-connector-list_progressRow__TCpzZ",progressBar:"onboarding-connector-list_progressBar___AVI9",progressFill:"onboarding-connector-list_progressFill__c_8vG",footer:"onboarding-connector-list_footer__JIJdE",action:"onboarding-connector-list_action__0ZvwA",empty:"onboarding-connector-list_empty__kvNzw"}},1682:function(e){e.exports={retryButton:"retry-button_retryButton__857bg",retryButtonLoading:"retry-button_retryButtonLoading__h_n3Q",retryButtonSpinner:"retry-button_retryButtonSpinner__jIZZ_","retry-button-spin":"retry-button_retry-button-spin__xpbOc",retryButtonLabel:"retry-button_retryButtonLabel__Tfn2J"}}},function(e){e.O(0,[717,570,589,142,48,888,774,179],function(){return e(e.s=1179)}),_N_E=e.O()}]);