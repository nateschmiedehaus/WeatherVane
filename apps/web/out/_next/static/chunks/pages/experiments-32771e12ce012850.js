(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[777],{6848:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/experiments",function(){return s(5092)}])},5092:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return H}});var t,i=s(5893),n=s(7294),l=s(9008),r=s.n(l),c=s(2570),d=s(6731),o=s(218),u=s.n(o);function h(e){let{points:a,title:s}=e,t=(0,n.useMemo)(()=>{var e,s;if(!a||a.length<2)return null;let t=a.map(e=>e.actual),i=a.map(e=>e.predicted),n=a.map(e=>{var a;return null!==(a=e.cumulative_lift)&&void 0!==a?a:null}).filter(e=>null!=e),l=[...t,...i],r=Math.min(...l),c=Math.max(...l)-r||1,d=e=>1===a.length?260:36+e/(a.length-1)*448,o=e=>180-(e-r)/c*160,u=n.length>0?{min:Math.min(...n),max:Math.max(...n)}:{min:0,max:0},h=u.max-u.min||1,m=(e,a)=>e.map((e,s)=>{let t=d(s),i=a(e);return"".concat(0===s?"M":"L").concat(t.toFixed(2),",").concat(i.toFixed(2))}).join(" "),p=m(t,o),v=m(i,o),x=n.length>0,g=x?m(a.map(e=>{var a;return null!==(a=e.cumulative_lift)&&void 0!==a?a:u.min}),e=>180-(e-u.min)/h*160):null,j=a[a.length-1],f=a.length-1,b=(()=>{if(!j.timestamp)return"—";let e=new Date(j.timestamp);return Number.isNaN(e.getTime())?"—":new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"}).format(e)})(),y=(()=>{if("number"==typeof j.cumulative_lift_pct)return"".concat((100*j.cumulative_lift_pct).toFixed(1),"%");if("string"==typeof j.cumulative_lift_pct&&j.cumulative_lift_pct.trim().length>0)return j.cumulative_lift_pct;let e=j.lift;return"number"==typeof e?"".concat((100*e).toFixed(1),"%"):"number"==typeof j.cumulative_lift?"".concat(j.cumulative_lift.toFixed(1)):"—"})(),N=Number.isFinite(j.actual)?j.actual:null!==(e=t.find(e=>Number.isFinite(e)))&&void 0!==e?e:0,_=Number.isFinite(j.predicted)?j.predicted:null!==(s=i.find(e=>Number.isFinite(e)))&&void 0!==s?s:0;return{actualPath:p,predictedPath:v,cumulativePath:g,hasCumulativeSeries:x,latestTimestamp:b,latestLiftLabel:y,latestX:d(f),latestActualY:o(N),latestPredictedY:o(_)}},[a]);if(!t)return(0,i.jsxs)("div",{className:u().chartCard,children:[(0,i.jsx)("h3",{className:"ds-title",children:null!=s?s:"Backtest timeline"}),(0,i.jsx)("p",{className:"".concat(u().chartEmpty," ds-body"),children:"Backtest data will appear once at least two performance snapshots are stored."})]});let{actualPath:l,predictedPath:r,cumulativePath:c,hasCumulativeSeries:d,latestTimestamp:o,latestLiftLabel:h,latestX:m,latestActualY:p,latestPredictedY:v}=t;return(0,i.jsxs)("div",{className:u().chartCard,children:[(0,i.jsxs)("div",{className:u().chartHeader,children:[(0,i.jsx)("h3",{className:"ds-title",children:null!=s?s:"Backtest timeline"}),(0,i.jsxs)("div",{className:"".concat(u().chartMeta," ds-caption"),children:[(0,i.jsxs)("span",{children:["Last updated: ",(0,i.jsx)("strong",{className:"ds-body-strong",children:o})]}),(0,i.jsxs)("span",{children:["Cumulative lift: ",(0,i.jsx)("strong",{className:"ds-body-strong",children:h})]})]})]}),(0,i.jsxs)("div",{className:"".concat(u().chartLegend," ds-caption"),children:[(0,i.jsx)("span",{className:u().legendActual,children:"Actual observed"}),(0,i.jsx)("span",{className:u().legendPredicted,children:"Predicted p50"}),d&&(0,i.jsx)("span",{className:u().legendCumulative,children:"Cumulative lift"})]}),(0,i.jsxs)("svg",{className:u().chartSvg,viewBox:"0 0 ".concat(520," ").concat(200),role:"img","aria-label":"Backtest chart showing actual vs predicted values over time",children:[(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:36,x2:484,y1:180,y2:180,className:u().chartAxis}),(0,i.jsx)("line",{x1:36,x2:36,y1:20,y2:180,className:u().chartAxis})]}),d&&c?(0,i.jsx)("path",{d:c,className:u().chartCumulative,fill:"none",vectorEffect:"non-scaling-stroke"}):null,(0,i.jsx)("path",{d:l,className:u().chartActual,fill:"none",vectorEffect:"non-scaling-stroke"}),(0,i.jsx)("path",{d:r,className:u().chartPredicted,fill:"none",vectorEffect:"non-scaling-stroke"}),(0,i.jsx)("circle",{cx:m,cy:p,r:4,className:u().chartActualMarker}),(0,i.jsx)("circle",{cx:m,cy:v,r:4,className:u().chartPredictedMarker})]}),(0,i.jsx)("div",{className:"".concat(u().chartFootnote," ds-caption"),children:"Daily points plot actual performance versus the model’s median forecast. Cumulative lift tracks the running delta between predicted and actual outcomes."})]})}var m=s(557);function p(e){var a,s;let{report:t}=e,n=t.top_creatives.slice(0,3),l=t.creatives.slice(0,8),r=(null!==(a=t.channel_guardrails)&&void 0!==a?a:[]).slice().sort((e,a)=>a.flagged_spend_share-e.flagged_spend_share),c=[{key:"active",label:"Active spend",value:t.summary.active_spend_share,tone:"active"},{key:"watchlist",label:"Watchlist spend",value:t.summary.watchlist_spend_share,tone:"caution"},{key:"blocked",label:"Blocked spend",value:t.summary.blocked_spend_share,tone:"critical"}],d=Object.entries(null!==(s=t.summary.guardrail_counts)&&void 0!==s?s:{}).filter(e=>{let[,a]=e;return a>0}).sort((e,a)=>a[1]-e[1]),o=e=>Number.isFinite(e)?Math.round(1e3*e)/10:0,h=e=>e.split("_").map(e=>"roas"===e.toLowerCase()?"ROAS":e.charAt(0).toUpperCase()+e.slice(1)).join(" "),m=e=>{if(0===e.flagged_creatives)return"0";let a=[];e.watchlist_creatives>0&&a.push("".concat(e.watchlist_creatives," watchlist")),e.blocked_creatives>0&&a.push("".concat(e.blocked_creatives," blocked"));let s=a.length>0?" (".concat(a.join(" \xb7 "),")"):"";return"".concat(e.flagged_creatives).concat(s)},p=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"",v=e=>{if(!e.representative_creative)return"—";let a=p(e.representative_status);return a?"".concat(e.representative_creative," (").concat(a,")"):e.representative_creative},x=e=>e.top_guardrail&&0!==e.top_guardrail_count?"".concat(h(e.top_guardrail)," (").concat(e.top_guardrail_count,")"):"Clear";return(0,i.jsxs)("section",{className:u().contextSection,"aria-label":"Creative guardrail status",children:[(0,i.jsxs)("div",{className:u().summaryCard,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Creative guardrails"}),(0,i.jsxs)("p",{className:"ds-body",children:["Monitoring brand safety and ROAS guardrails. Policy floor ",t.policy.roas_floor.toFixed(2),"\xd7 \xb7 warn threshold"," ",Math.round(100*t.policy.warn_threshold),"% \xb7 block threshold ",Math.round(100*t.policy.block_threshold),"%."]}),(0,i.jsxs)("dl",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Creatives scored"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:t.summary.creative_count})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Active"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:t.summary.active_creatives})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Watchlist"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:t.summary.watchlist_creatives})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Blocked"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:t.summary.blocked_creatives})]})]}),(0,i.jsx)("div",{className:u().guardrailSummary,role:"list","aria-label":"Spend distribution by guardrail status",children:c.map(e=>{let a=Math.min(100,Math.max(0,o(e.value)));return(0,i.jsxs)("div",{className:u().guardrailSummaryItem,role:"listitem",children:[(0,i.jsx)("span",{className:"ds-caption",children:e.label}),(0,i.jsx)("div",{className:u().guardrailBar,role:"meter","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":a,"aria-valuetext":"".concat(a.toFixed(1),"%"),children:(0,i.jsx)("div",{className:u().guardrailBarFill,"data-tone":e.tone,style:{width:"".concat(a,"%")}})}),(0,i.jsxs)("span",{className:"ds-body-strong",children:[a.toFixed(1),"% of spend"]})]},e.key)})}),(0,i.jsxs)("div",{className:u().guardrailBreakdown,"aria-live":"polite",children:[(0,i.jsx)("h4",{className:"ds-body-strong",children:"Guardrail triggers"}),d.length>0?(0,i.jsx)("ul",{className:u().guardrailBreakdownList,children:d.map(e=>{let[a,s]=e;return(0,i.jsxs)("li",{className:u().guardrailBreakdownItem,children:[(0,i.jsx)("span",{className:u().guardrailBreakdownLabel,children:h(a)}),(0,i.jsx)("span",{className:u().guardrailBreakdownCount,children:s})]},a)})}):(0,i.jsx)("p",{className:"".concat(u().guardrailBreakdownEmpty," ds-body"),children:"No guardrail flags detected. Creatives meet policy thresholds."})]})]}),r.length>0&&(0,i.jsxs)("div",{className:u().tableWrap,role:"region","aria-label":"Channel guardrail posture",children:[(0,i.jsxs)("div",{className:u().tableHeader,children:[(0,i.jsx)("h4",{className:"ds-body-strong",children:"Channel guardrail posture"}),(0,i.jsx)("p",{className:"ds-caption",children:"Sorted by flagged spend share to elevate riskiest surfaces."})]}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Channel"}),(0,i.jsx)("th",{scope:"col",children:"Active creatives"}),(0,i.jsx)("th",{scope:"col",children:"Flagged creatives"}),(0,i.jsx)("th",{scope:"col",children:"Flagged spend"}),(0,i.jsx)("th",{scope:"col",children:"Avg. adj. ROAS"}),(0,i.jsx)("th",{scope:"col",children:"Avg. brand safety"}),(0,i.jsx)("th",{scope:"col",children:"Dominant guardrail"}),(0,i.jsx)("th",{scope:"col",children:"Primary escalation"})]})}),(0,i.jsx)("tbody",{children:r.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.channel}),(0,i.jsx)("td",{children:"".concat(e.active_creatives," / ").concat(e.creative_count)}),(0,i.jsx)("td",{children:m(e)}),(0,i.jsx)("td",{children:"".concat(o(e.flagged_spend_share).toFixed(1),"%")}),(0,i.jsxs)("td",{children:[e.average_roas.toFixed(2),"\xd7"]}),(0,i.jsxs)("td",{children:[Math.round(100*e.average_brand_safety),"%"]}),(0,i.jsx)("td",{children:x(e)}),(0,i.jsx)("td",{children:v(e)})]},e.channel))})]})]}),(0,i.jsxs)("div",{className:u().summaryCard,"aria-label":"Top performing creatives",children:[(0,i.jsx)("h4",{className:"ds-body-strong",children:"Top creatives"}),(0,i.jsx)("ul",{className:u().creativeList,children:n.map(e=>(0,i.jsxs)("li",{className:"ds-body",children:[(0,i.jsx)("strong",{className:"ds-body-strong",children:e.creative_id})," \xb7 ",e.channel," \xb7"," ",e.roas_adjusted.toFixed(2),"\xd7 adj. ROAS \xb7 ",Math.round(100*e.brand_safety_score),"% safety \xb7"," ",e.status]},e.creative_id))})]}),(0,i.jsx)("div",{className:u().tableWrap,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Creative"}),(0,i.jsx)("th",{scope:"col",children:"Channel"}),(0,i.jsx)("th",{scope:"col",children:"Adj. ROAS"}),(0,i.jsx)("th",{scope:"col",children:"Status"}),(0,i.jsx)("th",{scope:"col",children:"Guardrail"}),(0,i.jsx)("th",{scope:"col",children:"Brand safety"})]})}),(0,i.jsx)("tbody",{children:l.map(e=>{var a;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.creative_id}),(0,i.jsx)("td",{children:e.channel}),(0,i.jsxs)("td",{children:[e.roas_adjusted.toFixed(2),"\xd7"]}),(0,i.jsx)("td",{children:e.status}),(0,i.jsx)("td",{children:null!==(a=e.guardrail)&&void 0!==a?a:"—"}),(0,i.jsxs)("td",{children:[Math.round(100*e.brand_safety_score),"%"]})]},e.creative_id)})})]})})]})}let v=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,x=e=>void 0!==e&&Number.isFinite(e)?"".concat((100*e).toFixed(1),"%"):"—",g=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),j=(e,a)=>e.find(e=>e.name===a);function f(e){var a,s,t,n,l;let{report:r}=e,c=Object.entries(r.q_values).sort((e,a)=>a[1]-e[1])[0],d=r.episodes.slice(-5),o=null!==(a=r.diagnostics.baseline_fraction)&&void 0!==a?a:0,h=null!==(s=r.diagnostics.safety_override_rate)&&void 0!==s?s:0,m=r.validation,p=null!==(t=m.checks)&&void 0!==t?t:[],f=null!==(n=m.notes)&&void 0!==n?n:[],b=m.summary,y=m.stress_test,N=y.episodes.slice(0,5),_=null!==(l=y.assertions)&&void 0!==l?l:{},w=function(e){var a,s,t,i,n,l;let r=null!==(i=null===(a=e.validation)||void 0===a?void 0:a.checks)&&void 0!==i?i:[],c=j(r,"baseline_fraction"),d=j(r,"guardrail_violations"),o="number"==typeof(null===(s=e.diagnostics)||void 0===s?void 0:s.baseline_fraction)?e.diagnostics.baseline_fraction:null==c?void 0:c.value,u="number"==typeof(null==c?void 0:c.threshold)?c.threshold:void 0,h="number"==typeof o&&(void 0===u||o+1e-6>=u),m="number"==typeof e.guardrail_violations?e.guardrail_violations:null!==(n=null==d?void 0:d.value)&&void 0!==n?n:0,p="number"==typeof(null==d?void 0:d.threshold)?d.threshold:"number"==typeof(null===(t=e.config)||void 0===t?void 0:t.max_guardrail_breaches)?e.config.max_guardrail_breaches:void 0,f=m<=0?"pass":void 0!==p&&m<p?"caution":"critical",b=p&&p>0?v(1-m/p):m<=0?1:0,y="number"==typeof o&&u&&u>0?v(o/u):h?1:0,N="number"==typeof o&&void 0!==u?"".concat(x(o)," \xb7 Min ").concat(x(u)):h?"Baseline coverage within guardrail":"Baseline coverage needs review",_=void 0!==p?"".concat(m," of ").concat(p," breaches"):"".concat(m," guardrail breaches"),w=r.filter(e=>!1===e.status),k=w.map(e=>g(e.name)),S=0===w.length&&"pass"===f?"pass":"critical"===f||w.some(e=>!1===e.status)?"critical":"caution",C=[];k.length>0&&C.push("".concat(k.length," validation check").concat(1===k.length?"":"s"," (").concat(k.join(", "),")")),m>0&&C.push("".concat(m," guardrail breach").concat(1===m?"":"es").concat(void 0!==p?" (limit ".concat(p,")"):"")),(null!==(l=e.disabled_variants)&&void 0!==l?l:[]).length>0&&C.push("".concat(e.disabled_variants.length," disabled variant").concat(1===e.disabled_variants.length?"":"s"));let F=0===C.length?"Validation and stress tests passed guardrail checks. Safe to continue shadow exploration.":"Resolve ".concat(C.join(" and ")," before expanding live exploration."),A=[];return A.push({label:"Baseline coverage",detail:N,progress:y,tone:h?"pass":"critical"}),A.push({label:"Guardrail breaches",detail:_,progress:b,tone:f}),{badgeTone:S,badgeLabel:"pass"===S?"Shadow gate clear":"caution"===S?"Needs attention":"Action required",message:F,items:A}}(r),k=e=>void 0===e||Number.isNaN(e)?"—":1>=Math.abs(e)?"".concat((100*e).toFixed(1),"%"):e.toFixed(2),S=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,i.jsxs)("section",{className:u().contextSection,"aria-label":"Reinforcement learning shadow mode",children:[(0,i.jsxs)("div",{className:u().summaryCard,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Reinforcement-learning shadow mode"}),(0,i.jsxs)("p",{className:"ds-body",children:["Safe exploration runs alongside production allocator to gauge lift before rollout. Average reward ",r.average_reward.toFixed(3)," \xb7 guardrail breaches ",r.guardrail_violations,"."]}),(0,i.jsxs)("dl",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Top variant"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:c?"".concat(c[0]," (").concat(c[1].toFixed(3)," avg reward)"):"n/a"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Explored variants"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:Object.keys(r.selection_counts).length})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Disabled variants"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:r.disabled_variants.length?r.disabled_variants.join(", "):"None"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Baseline coverage"}),(0,i.jsxs)("dd",{className:"ds-body-strong",children:[(100*o).toFixed(1),"%"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Safety overrides"}),(0,i.jsxs)("dd",{className:"ds-body-strong",children:[(100*h).toFixed(1),"%"]})]})]}),b&&(0,i.jsxs)("dl",{className:u().validationSummary,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Episodes simulated"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:b.episodes})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Shadow override rate"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:k(b.safety_override_rate)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Variants disabled"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:b.disabled_variants.length?b.disabled_variants.join(", "):"None"})]})]})]}),(0,i.jsxs)("div",{className:u().validationGrid,children:[(0,i.jsxs)("div",{className:u().validationCard,"aria-label":"Safety validation checks",children:[(0,i.jsx)("h4",{className:"ds-title",children:"Validation checks"}),(0,i.jsx)("ul",{className:u().validationList,children:p.map(e=>(0,i.jsxs)("li",{className:u().validationItem,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"ds-body-strong",children:S(e.name)}),(0,i.jsxs)("span",{className:u().validationMetric,children:["Value ",k(e.value)," \xb7 Threshold ",k(e.threshold),"number"==typeof e.required_baseline_runs&&"number"==typeof e.observed_baseline_runs?(0,i.jsxs)(i.Fragment,{children:[" \xb7 Runs ",e.observed_baseline_runs,"/",e.required_baseline_runs]}):null]})]}),(0,i.jsx)("span",{className:"".concat(u().validationBadge," ").concat(e.status?u().validationPass:u().validationFail),children:e.status?"Pass":"Fail"})]},e.name))}),f.length>0&&(0,i.jsx)("ul",{className:u().validationNotes,children:f.map(e=>(0,i.jsx)("li",{className:"ds-body",children:e},e))})]}),(0,i.jsxs)("div",{className:u().validationCard,"aria-label":"Guardrail stress test",children:[(0,i.jsx)("h4",{className:"ds-title",children:"Guardrail stress test"}),(0,i.jsx)("p",{className:"ds-body",children:"Forced sequence injects a synthetic breach to ensure automatic disablement and logging paths remain healthy."}),(0,i.jsxs)("dl",{className:u().validationSummary,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Breaches recorded"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:y.guardrail_violations})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Disabled variants"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:y.disabled_variants.length?y.disabled_variants.join(", "):"None"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Assertions"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:Object.entries(_).map(e=>{let[a,s]=e;return"".concat(S(a),": ").concat(s?"True":"False")}).join(" \xb7 ")})]})]}),N.length>0&&(0,i.jsx)("div",{className:u().tableWrap,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Episode"}),(0,i.jsx)("th",{scope:"col",children:"Variant"}),(0,i.jsx)("th",{scope:"col",children:"Guardrail"}),(0,i.jsx)("th",{scope:"col",children:"Disabled"})]})}),(0,i.jsx)("tbody",{children:N.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.index}),(0,i.jsx)("td",{children:e.variant}),(0,i.jsx)("td",{children:e.guardrail_violated?"⚠ Breach":"—"}),(0,i.jsx)("td",{children:e.disabled_after_episode?"Yes":"No"})]},e.index))})]})})]})]}),(0,i.jsxs)("div",{className:u().guardrailStatus,children:[(0,i.jsx)("span",{className:u().guardrailStatusBadge,"data-tone":w.badgeTone,children:w.badgeLabel}),(0,i.jsx)("p",{className:"ds-body",children:w.message}),(0,i.jsx)("div",{className:u().guardrailSummary,children:w.items.map(e=>{let a=Math.min(100,Math.max(0,Math.round(100*e.progress)));return(0,i.jsxs)("div",{className:u().guardrailSummaryItem,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"ds-caption",children:e.label}),(0,i.jsx)("span",{className:"ds-body-strong",children:e.detail})]}),(0,i.jsx)("div",{className:u().guardrailBar,role:"presentation",children:(0,i.jsx)("div",{className:u().guardrailBarFill,style:{width:"".concat(a,"%")},"data-tone":"pass"===e.tone?void 0:e.tone})})]},e.label)})})]}),(0,i.jsx)("div",{className:u().tableWrap,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Episode"}),(0,i.jsx)("th",{scope:"col",children:"Variant"}),(0,i.jsx)("th",{scope:"col",children:"Reward"}),(0,i.jsx)("th",{scope:"col",children:"Candidate profit"}),(0,i.jsx)("th",{scope:"col",children:"Guardrail"}),(0,i.jsx)("th",{scope:"col",children:"Safety override"})]})}),(0,i.jsx)("tbody",{children:d.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.index}),(0,i.jsx)("td",{children:e.variant}),(0,i.jsx)("td",{children:e.reward.toFixed(3)}),(0,i.jsx)("td",{children:e.candidate_profit.toFixed(2)}),(0,i.jsx)("td",{children:e.guardrail_violated?"⚠":"—"}),(0,i.jsx)("td",{children:e.safety_override?"Applied":"—"})]},e.index))})]})})]})}function b(e){let{report:a}=e,s=a.markets.slice(0,6);return(0,i.jsxs)("section",{className:u().contextSection,"aria-label":"Cross-market saturation optimisation",children:[(0,i.jsxs)("div",{className:u().summaryCard,children:[(0,i.jsx)("h3",{className:"ds-title",children:"Cross-market saturation optimisation"}),(0,i.jsxs)("p",{className:"ds-body",children:["Fairness floor ",Math.round(100*a.fairness_floor),"% \xb7 baseline profit ",a.summary.baseline_profit.toFixed(2)," \xb7 projected profit"," ",a.summary.profit.toFixed(2)," \xb7 lift ",(a.summary.profit_lift>=0?"+":"")+a.summary.profit_lift.toFixed(2),"."]}),(0,i.jsxs)("dl",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Weighted fairness gap"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.weighted_fairness_gap.toFixed(3)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Max gap"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.max_fairness_gap.toFixed(3)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Total spend"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.total_spend.toFixed(2)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Normalised gap"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.normalized_fairness_gap.toFixed(3)})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Under-allocated"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.under_allocated_markets})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Floor shortfall"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:a.summary.total_floor_shortfall.toFixed(2)})]})]})]}),(0,i.jsx)("div",{className:u().tableWrap,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{scope:"col",children:"Market"}),(0,i.jsx)("th",{scope:"col",children:"Spend"}),(0,i.jsx)("th",{scope:"col",children:"Share"}),(0,i.jsx)("th",{scope:"col",children:"Fair share"}),(0,i.jsx)("th",{scope:"col",children:"Δ vs fair"}),(0,i.jsx)("th",{scope:"col",children:"Floor shortfall"}),(0,i.jsx)("th",{scope:"col",children:"Adj. ROAS"}),(0,i.jsx)("th",{scope:"col",children:"Guardrail"})]})}),(0,i.jsx)("tbody",{children:s.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.allocated_spend.toFixed(2)}),(0,i.jsxs)("td",{children:[Math.round(100*e.share),"%"]}),(0,i.jsxs)("td",{children:[Math.round(100*e.fair_share),"%"]}),(0,i.jsx)("td",{children:"".concat(e.fairness_gap>=0?"+":"").concat(Math.round(100*e.fairness_gap),"%")}),(0,i.jsx)("td",{children:e.floor_shortfall.toFixed(2)}),(0,i.jsxs)("td",{children:[e.roas.toFixed(2),"\xd7"]}),(0,i.jsx)("td",{children:e.guardrail_binding?"Binding":"Clear"})]},e.name))})]})})]})}function y(e){var a;let{summary:s}=e;return(0,i.jsxs)("div",{className:"".concat(u().summaryCard," ds-surface-card"),"aria-label":"Executive summary for experiments hub",children:[(0,i.jsxs)("div",{className:u().experimentSummaryHeader,children:[(0,i.jsxs)("div",{className:u().experimentSummaryTitle,children:[(0,i.jsx)("h3",{className:"ds-title",children:s.headline}),(0,i.jsxs)("div",{className:u().experimentSummaryBadges,children:[(0,i.jsx)("span",{className:"ds-badge","data-tone":s.decisionTone,children:s.decisionLabel}),(0,i.jsx)("span",{className:"ds-badge","data-tone":"high"===(a=s.confidenceLevel)?"success":"medium"===a?"caution":"info",children:s.confidenceBadge})]})]}),s.generatedAt&&(0,i.jsxs)("span",{className:"ds-caption",children:["Updated ",new Date(s.generatedAt).toLocaleString()]})]}),(0,i.jsxs)("div",{className:u().experimentSummaryContent,children:[(0,i.jsx)("p",{className:"ds-body",children:s.liftNarrative}),(0,i.jsx)("p",{className:"ds-body",children:s.confidenceNarrative}),(0,i.jsx)("p",{className:"ds-body",children:s.recommendation}),(0,i.jsxs)("div",{className:u().experimentSummaryFallback,children:[(0,i.jsx)("span",{className:"ds-caption",children:"Fallback"}),(0,i.jsx)("p",{className:"ds-body",children:s.fallbackPlan})]}),s.riskCallout&&(0,i.jsxs)("div",{className:u().experimentSummaryRisk,children:[(0,i.jsx)("span",{className:"ds-caption",children:"Risks"}),(0,i.jsx)("p",{className:"ds-body",children:s.riskCallout})]})]})]})}let N={success:"success",info:"info",caution:"caution",critical:"critical"};function _(e){let{signals:a}=e;return 0===a.length?(0,i.jsxs)("div",{className:"".concat(u().summaryCard," ds-surface-card"),"aria-label":"Instrumentation health",children:[(0,i.jsx)("h3",{className:"ds-body-strong",children:"Instrumentation health"}),(0,i.jsx)("p",{className:"ds-body",children:"No telemetry captured yet. Confirm webhook delivery and holdout design status."})]}):(0,i.jsxs)("div",{className:"".concat(u().summaryCard," ds-surface-card"),"aria-label":"Instrumentation health",children:[(0,i.jsxs)("div",{className:u().instrumentationHeader,children:[(0,i.jsx)("h3",{className:"ds-body-strong",children:"Instrumentation health"}),(0,i.jsx)("p",{className:"ds-caption",children:"Telemetry guardrails covering sample sufficiency, randomisation, coverage, and webhook delivery."})]}),(0,i.jsx)("ul",{className:u().instrumentationSignals,children:a.map(e=>(0,i.jsxs)("li",{className:u().instrumentationSignal,children:[(0,i.jsxs)("div",{className:u().instrumentationSignalLabel,children:[(0,i.jsx)("span",{className:"ds-body-strong",children:e.label}),(0,i.jsx)("span",{className:"ds-badge","data-tone":N[e.tone],children:e.value})]}),(0,i.jsx)("p",{className:"ds-caption",children:e.detail})]},e.id))})]})}let w=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0});function k(e){return null==e||Number.isNaN(e)?"—":w.format(e)}function S(e){return null==e||Number.isNaN(e)?"—":"".concat((100*e).toFixed(1),"%")}function C(e){return"number"==typeof e&&Number.isFinite(e)?e:null}function F(e){let a=null==e?void 0:e.performance_summary;if(!a||"object"!=typeof a)return{status:"unknown",coverage:null,failingHorizons:[]};let s="string"==typeof a.status?a.status:"unknown",t=null,i=a.summary;if(i&&"object"==typeof i){let e=i.coverage;if(e&&"object"==typeof e){let a=e.coverage;"number"==typeof a&&Number.isFinite(a)&&(t=a)}}return{status:s,coverage:t,failingHorizons:Array.isArray(a.failing_horizons)?a.failing_horizons.filter(e=>"string"==typeof e):[]}}function A(e){if(!e)return null;let a=new Date(e);return Number.isNaN(a.getTime())?null:a.toISOString()}async function E(e){if(navigator.clipboard&&"function"==typeof navigator.clipboard.writeText){await navigator.clipboard.writeText(e);return}let a=document.createElement("textarea");a.value=e,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a)}function M(e){let{report:a,executiveSummary:s,signals:t,disabled:l}=e,[r,c]=(0,n.useState)(null),[d,o]=(0,n.useState)(null),h=(0,n.useCallback)(()=>({report:a,executiveSummary:s,signals:t}),[a,s,t]),m=(0,n.useCallback)(()=>{try{let e=h(),s=function(e){var a,s,t,i,n,l,r,c,d,o,u;let h=[],{report:m,executiveSummary:p,signals:v}=e,x=null!==(a=null==m?void 0:m.summary)&&void 0!==a?a:null;h.push(["Section","Metric","Value","Notes"]),h.push(["Executive","Headline",null!==(s=null==p?void 0:p.headline)&&void 0!==s?s:"Awaiting experiment telemetry",null!==(t=null==p?void 0:p.liftNarrative)&&void 0!==t?t:"Telemetry pending."]),h.push(["Executive","Decision",null!==(i=null==p?void 0:p.decisionLabel)&&void 0!==i?i:"Hold decision",null!==(n=null==p?void 0:p.recommendation)&&void 0!==n?n:"Await additional data before acting."]),h.push(["Executive","Confidence",null!==(l=null==p?void 0:p.confidenceNarrative)&&void 0!==l?l:"Confidence will populate after first run.",null!==(r=null==p?void 0:p.riskCallout)&&void 0!==r?r:""]),x&&(h.push(["Experiment","Lift %",S(x.lift),"Absolute lift ".concat(k(x.absolute_lift))]),h.push(["Experiment","Confidence interval","".concat(k(x.conf_low)," – ").concat(k(x.conf_high)),"95% confidence band"]),h.push(["Experiment","Sample sizes","Treatment ".concat(null!==(o=null===(c=x.sample_size_treatment)||void 0===c?void 0:c.toLocaleString())&&void 0!==o?o:"—"," \xb7 Control ").concat(null!==(u=null===(d=x.sample_size_control)||void 0===d?void 0:d.toLocaleString())&&void 0!==u?u:"—"),""])),v.forEach(e=>{h.push(["Instrumentation",e.label,e.value,e.detail])});let g=F(m).coverage;return null!==g&&h.push(["Forecast","Coverage",S(g),"Coverage vs target"]),h.map(e=>e.map(e=>{var a;return(a=null!=e?e:"").includes(",")||a.includes('"')||a.includes("\n")?'"'.concat(a.replace(/"/g,'""'),'"'):a}).join(",")).join("\n")}(e),t=function(e,a){var s;let t=(null==e?void 0:e.tenant_id)?e.tenant_id.replace(/[^a-zA-Z0-9_-]/g,"-"):"experiments",i=(null!==(s=A(null==e?void 0:e.generated_at))&&void 0!==s?s:new Date().toISOString()).replace(/[:]/g,"-");return"".concat(t,"-experiment-").concat(i,".").concat("csv").toLowerCase()}(a,0);!function(e,a,s){let t=new Blob([e],{type:s}),i=URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=a,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}(s,t,"text/csv"),c("CSV export downloaded."),o(null)}catch(e){o(e instanceof Error?e.message:"Failed to generate CSV export."),c(null)}},[h,a]),p=(0,n.useCallback)(async()=>{try{let e=h(),a=function(e){var a,s,t,i,n,l,r,c,d,o,u;let{report:h,executiveSummary:m,signals:p}=e,v=null!==(a=null==h?void 0:h.summary)&&void 0!==a?a:null,x=[];x.push("## Experiments Hub Executive Brief"),x.push(""),x.push("Headline: ".concat(null!==(s=null==m?void 0:m.headline)&&void 0!==s?s:"Awaiting experiment telemetry")),x.push("Decision: ".concat(null!==(t=null==m?void 0:m.decisionLabel)&&void 0!==t?t:"Hold decision"," (").concat(null!==(i=null==m?void 0:m.confidenceNarrative)&&void 0!==i?i:"Confidence pending.",")")),x.push("Recommendation: ".concat(null!==(n=null==m?void 0:m.recommendation)&&void 0!==n?n:"Await additional data before acting.")),(null==m?void 0:m.riskCallout)&&x.push("Risks: ".concat(m.riskCallout)),x.push(""),x.push("### Experiment Results"),v?(x.push("• Observed lift: ".concat(S(v.lift)," (").concat(k(v.absolute_lift)," incremental revenue)")),x.push("• Confidence interval: ".concat(k(v.conf_low)," – ").concat(k(v.conf_high))),x.push("• Sample sizes: Treatment ".concat(null!==(c=null===(l=v.sample_size_treatment)||void 0===l?void 0:l.toLocaleString())&&void 0!==c?c:"—"," \xb7 Control ").concat(null!==(d=null===(r=v.sample_size_control)||void 0===r?void 0:r.toLocaleString())&&void 0!==d?d:"—"))):x.push("• Lift pending first observation window."),x.push(""),x.push("### Instrumentation Health"),0===p.length?x.push("• Instrumentation telemetry pending."):p.forEach(e=>{x.push("• ".concat(e.label,": ").concat(e.value," — ").concat(e.detail))}),x.push(""),x.push("### Next Steps & Fallback"),x.push("• Primary action: ".concat(null!==(o=null==m?void 0:m.recommendation)&&void 0!==o?o:"Collect additional telemetry.")),x.push("• Fallback plan: ".concat(null!==(u=null==m?void 0:m.fallbackPlan)&&void 0!==u?u:"If lift remains inconclusive, rerun with larger sample."));let g=null==m?void 0:m.generatedAt;return g&&(x.push(""),x.push("Generated at: ".concat(g))),x.join("\n")}(e);await E(a),c("Slides outline copied to clipboard."),o(null)}catch(e){o(e instanceof Error?e.message:"Failed to copy slides outline."),c(null)}},[h]);return(0,i.jsxs)("div",{className:"".concat(u().summaryCard," ds-surface-card"),"aria-label":"Share experiment results",children:[(0,i.jsxs)("div",{className:u().exportHeader,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"ds-body-strong",children:"Share experiment insights"}),(0,i.jsx)("p",{className:"ds-body",children:"Download a CSV package with lift metrics and telemetry, or copy the board-ready slide outline to brief stakeholders in minutes."})]}),(0,i.jsxs)("div",{className:u().exportActions,children:[(0,i.jsx)("button",{type:"button",className:u().exportButton,onClick:m,disabled:l,children:"Download CSV"}),(0,i.jsx)("button",{type:"button",className:u().exportButtonSecondary,onClick:p,disabled:l,children:"Copy slide outline"})]})]}),(r||d)&&(0,i.jsxs)("div",{className:u().exportStatus,role:"status",children:[r&&(0,i.jsx)("span",{className:"ds-caption","data-tone":"success",children:r}),d&&(0,i.jsx)("span",{className:"ds-caption","data-tone":"critical",children:d})]})]})}var L=s(6091),B=s(1916),T=s(5777);let z=null!==(t=s(3454).env.NEXT_PUBLIC_TENANT_ID)&&void 0!==t?t:"demo-tenant";function H(){var e,a,s,t;let{theme:l}=(0,B.F)(),o=(0,T.W)(l,"experiments"),[v,x]=(0,n.useState)(null),[g,j]=(0,n.useState)(!0),[N,w]=(0,n.useState)(null),[E,H]=(0,n.useState)(null),[R,I]=(0,n.useState)(null),[D,P]=(0,n.useState)(null),[O,W]=(0,n.useState)(null),[U,V]=(0,n.useState)(null),[G,q]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=!0;return j(!0),(0,L.DA)(z).then(a=>{e&&(x(a),w(null))}).catch(a=>{var s;e&&w(null!==(s=a.message)&&void 0!==s?s:"Failed to load experiment")}).finally(()=>{e&&j(!1)}),()=>{e=!1}},[]),(0,n.useEffect)(()=>{let e=!0;return(0,L.Pb)(z).then(a=>{e&&(H(a),I(null))}).catch(a=>{var s;e&&(I(null!==(s=a.message)&&void 0!==s?s:"Failed to load creative guardrails"),H(null))}),()=>{e=!1}},[]),(0,n.useEffect)(()=>{let e=!0;return(0,L.l5)(z).then(a=>{e&&(P(a),W(null))}).catch(a=>{var s;e&&(W(null!==(s=a.message)&&void 0!==s?s:"Failed to load RL shadow report"),P(null))}),()=>{e=!1}},[]),(0,n.useEffect)(()=>{let e=!0;return(0,L.Dq)(z).then(a=>{e&&(V(a),q(null))}).catch(a=>{var s;e&&(q(null!==(s=a.message)&&void 0!==s?s:"Failed to load saturation optimisation report"),V(null))}),()=>{e=!1}},[]);let X=null!==(a=null==v?void 0:v.backtest)&&void 0!==a?a:[],Y=null==v?void 0:v.performance_summary,K=g||N?null:v,Z=function(e){var a,s,t,i,n,l,r,c;let d=null!==(a=null==e?void 0:e.summary)&&void 0!==a?a:null,o=null!==(s=null==e?void 0:e.design)&&void 0!==s?s:null,u=F(e),h=[],m=null!==(t=null==d?void 0:d.sample_size_treatment)&&void 0!==t?t:null,p=null!==(i=null==d?void 0:d.sample_size_control)&&void 0!==i?i:null,v=(null!=m?m:0)+(null!=p?p:0),x=v>0?"Treatment ".concat(null!==(n=null==m?void 0:m.toLocaleString())&&void 0!==n?n:"—"," \xb7 Control ").concat(null!==(l=null==p?void 0:p.toLocaleString())&&void 0!==l?l:"—"," participants"):"No observations captured yet.";h.push({id:"sample_size",label:"Sample size",value:v>0?"".concat(v.toLocaleString()," events"):"Awaiting telemetry",tone:v>0?v>=800?"success":v>=400?"caution":"critical":"caution",detail:x});let g=null!==(c=null!==(r=C(null==o?void 0:o.control_share))&&void 0!==r?r:C(null==o?void 0:o.holdout_ratio))&&void 0!==c?c:.5,j=v>0&&null!==m?m/v:null,f=null===j?null:Math.abs(j-(1-g)),b="info",y="Randomisation health pending sample collection.",N="Pending";null!==j&&(N="".concat(null==j||Number.isNaN(j)?"—":"".concat(Math.round(100*j),"%")," treatment"),null!==f&&(f<=.05?(b="success",y="Treatment vs control within \xb15% of design target."):f<=.1?(b="caution",y="Slight imbalance detected; monitor assignments before approving lift."):(b="critical",y="Large imbalance between treatment and control; replenish holdout before acting."))),h.push({id:"treatment_balance",label:"Treatment balance",value:N,tone:b,detail:y});let _=u.coverage,w="info",k="Forecast coverage telemetry not yet available.";if(null!==_){w=_>=.85?"success":_>=.75?"caution":"critical";let e=u.failingHorizons.length>0?"Failing horizons: ".concat(u.failingHorizons.join(", ")," day(s)."):"All horizons meeting the target window.";k="".concat(S(_)," coverage vs 80% target. ").concat(e)}h.push({id:"forecast_coverage",label:"Forecast coverage",value:null!==_?S(_):"Awaiting coverage feed",tone:w,detail:k});let A="info",E="Monitoring",M="Webhook delivery health unknown; confirm instrumentation dashboard.";return"ok"===u.status?(A="success",E="Healthy",M="Allocator telemetry flowing; no delivery gaps detected."):"coverage_below_threshold"===u.status?(A="caution",E="Degraded",M="Coverage dipped below the 80% guardrail. Investigate missing events or replay webhooks."):"missing_data"===u.status&&(A="critical",E="No data",M="No recent experiment telemetry recorded; validate webhook + ETL status."),h.push({id:"webhook_delivery",label:"Webhook status",value:E,tone:A,detail:M}),h}(K),J=function(e,a){var s,t,i,n,l,r;let c=null!==(s=null==e?void 0:e.summary)&&void 0!==s?s:null,d=F(e),o=function(e){if(!e)return 0;let a="number"==typeof e.p_value?e.p_value:1;return Number.isFinite(a)?Math.max(0,Math.min(99,Math.round(100*(1-Math.max(0,Math.min(1,a)))))):0}(c),u=o>=95?"high":o>=80?"medium":"low",h=A(null==c?void 0:c.generated_at),m=(null!=a?a:[]).filter(e=>"caution"===e.tone||"critical"===e.tone);if(!c)return{headline:"Awaiting experiment telemetry",liftNarrative:"Treatment vs control performance will populate once lift is calculated.",confidenceNarrative:"WeatherVane will publish confidence once the first observation window completes.",confidenceBadge:"Confidence pending",confidenceLevel:u,decisionLabel:"Hold decision",decisionTone:"info",recommendation:"Keep budgets steady until the experiment runs long enough to generate lift.",fallbackPlan:"If telemetry remains missing for 24 hours, trigger instrumentation replay and confirm webhook health checks.",riskCallout:"missing_data"===d.status?"No experiment events received in the latest cycle.":null,generatedAt:h};let p="number"==typeof c.lift?c.lift:0,v=0!==p?"Treatment outperformed control by ".concat(S(p)," lift (").concat(k(c.absolute_lift)," incremental revenue)."):"Treatment performance matched the control; lift is effectively flat.",x=null!==(i=c.is_significant)&&void 0!==i?i:(null!==(t=c.p_value)&&void 0!==t?t:1)<.05,g=(null!==(n=c.absolute_lift)&&void 0!==n?n:0)>0,j=(null!==(l=c.sample_size_treatment)&&void 0!==l?l:0)+(null!==(r=c.sample_size_control)&&void 0!==r?r:0),f="Hold decision",b="info",y="Monitor the next observation window, then revisit once confidence crosses the 80% guardrail.",N="If lift remains inconclusive, plan a rerun with extended duration or broadened geo coverage.";return x&&g?(f="Approve uplift",b=m.length>0?"caution":"success",y="Authorize the recommended budget increase and brief finance on the incremental revenue expectation.",N="If conversion quality drifts, revert top underperforming geos to baseline while keeping incident logging active."):x&&!g?(f="Pause expansion",b="critical",y="Halt incremental spend and run instrumentation for regression. Share findings with the allocator strike team.",N="Switch the affected markets back to control allocations and escalate to allocator operations for remediation."):!x&&g?(f="high"===u?"Approve uplift":"Hold decision",b="high"===u?"caution":"info",y="high"===u?"Proceed with a limited rollout while extending the observation window for confirmation.":"Extend the test window or enlarge the holdout until confidence clears the 80% guardrail."):(f="Hold decision",b="info"),j<400&&(y="Grow the sample to at least 400 observations before presenting lift to leadership."),{headline:g?"Experiment indicates incremental revenue lift":"Experiment lift requires further validation",liftNarrative:v,confidenceNarrative:o>0?"WeatherVane is ".concat(o,"% confident the observed lift reflects true revenue impact."):"Confidence remains low until we gather more signal.",confidenceBadge:o>0?"".concat(o,"% confidence"):"Confidence pending",confidenceLevel:u,decisionLabel:f,decisionTone:b,recommendation:y,fallbackPlan:N,riskCallout:m.length>0?m.map(e=>"".concat(e.label,": ").concat(e.detail)).join(" "):null,generatedAt:h}}(K,Z);return(0,i.jsxs)(c.A,{children:[(0,i.jsx)(r(),{children:(0,i.jsx)("title",{children:"WeatherVane \xb7 Experiments"})}),(0,i.jsxs)("div",{className:u().root,style:o,children:[(0,i.jsx)(m.W,{message:"Experiments measure correlations today; causal validation under active development."}),(0,i.jsx)("section",{className:u().header,children:(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{children:"Geo Holdout Experiments"}),(0,i.jsx)("p",{children:"Track weather impact experiments. Use the control group as baseline, then quantify lift and significance to build trust with marketing and finance teams."})]})}),g&&(0,i.jsx)("p",{className:u().status,children:"Loading experiment design…"}),N&&(0,i.jsx)("p",{className:u().error,children:N}),K&&J&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsx)(y,{summary:J})}),K&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsx)(_,{signals:Z})}),K&&J&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsx)(M,{report:K,executiveSummary:J,signals:Z,disabled:!!N})}),K&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsx)(d.L,{design:K.design,summary:null!==(s=K.summary)&&void 0!==s?s:null})}),K&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsx)(h,{points:X,title:"Backtest timeline"})}),K&&(null==Y?void 0:Y.summary)&&(0,i.jsx)("section",{className:u().contextSection,children:(0,i.jsxs)("div",{className:u().summaryCard,children:[(0,i.jsx)("h3",{children:"Forecast coverage"}),(0,i.jsxs)("p",{children:["Overall p10–p90 coverage: ",Math.round((null!==(t=null===(e=Y.summary.coverage)||void 0===e?void 0:e.coverage)&&void 0!==t?t:0)*100),"%"]}),Y.failing_horizons&&Y.failing_horizons.length>0?(0,i.jsxs)("p",{className:u().error,children:["Horizon bands below target: ",Y.failing_horizons.join(", ")," day lookahead."]}):(0,i.jsx)("p",{children:"All horizons meet the target coverage."}),Y.summary&&Y.summary.coverage_by_horizon&&(0,i.jsx)("dl",{children:Object.entries(Y.summary.coverage_by_horizon).map(e=>{var a;let[s,t]=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("dt",{children:["Day ",s]}),(0,i.jsxs)("dd",{children:[Math.round((null!==(a=null==t?void 0:t.coverage)&&void 0!==a?a:0)*100),"%"]})]},s)})})]})}),R&&(0,i.jsxs)("p",{className:u().error,children:["Creative guardrails unavailable: ",R]}),E&&(0,i.jsx)(p,{report:E}),O&&(0,i.jsxs)("p",{className:u().error,children:["RL shadow mode unavailable: ",O]}),D&&(0,i.jsx)(f,{report:D}),G&&(0,i.jsxs)("p",{className:u().error,children:["Saturation optimisation unavailable: ",G]}),U&&(0,i.jsx)(b,{report:U})]})]})}}},function(e){e.O(0,[717,570,589,48,888,774,179],function(){return e(e.s=6848)}),_N_E=e.O()}]);