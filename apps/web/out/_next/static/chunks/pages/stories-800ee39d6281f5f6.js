(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[368],{8915:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stories",function(){return n(1732)}])},5795:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var a=n(5893),s=n(7294),i=n(5201),r=n.n(i);function l(e){let{title:t="Data context",tags:n=[],warnings:i=[]}=e,l=(0,s.useId)();if(0===n.length&&0===i.length)return null;let o=i.some(e=>"string"==typeof e.severity&&"critical"===e.severity.toLowerCase()),c=e=>{let t="string"==typeof e?e.toLowerCase():"";return"critical"===t?r().warningCritical:"warning"===t?r().warningCaution:r().warningInfo};return(0,a.jsxs)("section",{className:"".concat(r().panel," ds-surface-panel"),"aria-labelledby":l,role:"region",children:[(0,a.jsxs)("div",{className:r().header,children:[(0,a.jsx)("h3",{id:l,className:"".concat(r().heading," ds-title"),children:t}),o&&(0,a.jsx)("span",{className:"ds-badge","data-tone":"critical",children:"Action needed"})]}),n.length>0&&(0,a.jsx)("p",{className:"".concat(r().tags," ds-caption"),children:n.join(", ")}),i.length>0&&(0,a.jsx)("ul",{className:r().warningList,"aria-live":"polite",children:i.map(e=>{var t;return(0,a.jsxs)("li",{className:"".concat(r().warningItem," ").concat(c(e.severity)),children:[(0,a.jsx)("strong",{className:"ds-caption",children:(null!==(t=e.severity)&&void 0!==t?t:"warning").toUpperCase()}),(0,a.jsx)("span",{className:"ds-body",children:e.message})]},e.code)})})]})}},918:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var a=n(5893),s=n(7294),i=function(){for(var e,t,n=0,a="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=function e(t){var n,a,s="";if("string"==typeof t||"number"==typeof t)s+=t;else if("object"==typeof t){if(Array.isArray(t)){var i=t.length;for(n=0;n<i;n++)t[n]&&(a=e(t[n]))&&(s&&(s+=" "),s+=a)}else for(a in t)t[a]&&(s&&(s+=" "),s+=a)}return s}(e))&&(a&&(a+=" "),a+=t);return a},r=n(1682),l=n.n(r);let o=(0,s.forwardRef)((e,t)=>{let{className:n,type:s,loading:r=!1,loadingText:o,disabled:c,children:d,...u}=e,h=!!r,_=h&&null!=o?o:d;return(0,a.jsx)("button",{...u,ref:t,type:null!=s?s:"button",className:i("ds-body-strong",l().retryButton,h&&l().retryButtonLoading,n),disabled:c||h,"data-loading":h||void 0,"aria-busy":!!h||void 0,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{"aria-hidden":!0,className:l().retryButtonSpinner}),(0,a.jsx)("span",{className:l().retryButtonLabel,children:_})]}):_})});o.displayName="RetryButton"},1732:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var a,s,i=n(5893),r=n(7294),l=n(9008),o=n.n(l),c=n(1664),d=n.n(c),u=n(2570),h=n(5795),_=n(918),m=n(4612),p=n.n(m),g=n(6091);let x=RegExp("(?<=[.!?])\\s+(?=[A-Z0-9])","u"),y=/^[\s\u2022\u2023\u25E6\u2043\u2219·•\-–—]+/u;function f(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Math.max(1,null!==(t=n.limit)&&void 0!==t?t:3);if("string"!=typeof e||""===e.trim())return[];let s=e.split(/\r?\n/u).flatMap(e=>e.split(x)).map(e=>(function(e){let t=e.replace(y,"").trim();if(!t)return"";let n=t.replace(/\s+/g," ").trim();return n.length?n:""})(e)).filter(e=>e.length>=12),i=[],r=new Set;for(let e of s){let t=e.endsWith(".")?e.slice(0,-1):e;if(!(!t||r.has(t.toLowerCase()))&&(r.add(t.toLowerCase()),i.push(t),i.length>=a))break}return i}function j(e){let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleDateString(void 0,{month:"short",day:"numeric"})}var v=n(3454);let N=null!==(a=v.env.NEXT_PUBLIC_TENANT_ID)&&void 0!==a?a:"demo-tenant",b=Number(null!==(s=v.env.NEXT_PUBLIC_PLAN_HORIZON)&&void 0!==s?s:"7");function w(){var e,t,n,a,s,l;let[c,m]=(0,r.useState)(null),[x,y]=(0,r.useState)(!0),[v,w]=(0,r.useState)(null),[C,L]=(0,r.useState)(0),[S,I]=(0,r.useState)(null),[E,B]=(0,r.useState)(null),R=(0,r.useRef)(null),k=(0,r.useCallback)(()=>{let e=!0;return y(!0),(0,g.dp)(N,b).then(t=>{e&&(m(t),w(null))}).catch(t=>{var n;e&&w(null!==(n=t.message)&&void 0!==n?n:"Failed to load weather stories")}).finally(()=>{e&&y(!1)}),()=>{e=!1}},[]);(0,r.useEffect)(()=>k(),[k,C]);let D=(0,r.useCallback)(async e=>{let t="".concat(e.plan_date,"-").concat(e.category,"-").concat(e.channel);null!==R.current&&(window.clearTimeout(R.current),R.current=null);try{let n=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null!==(t=n.highlights)&&void 0!==t?t:f(e.detail,{limit:3}),s=[];return s.push("".concat(e.title," — ").concat(e.channel," (").concat(e.confidence,")")),s.push("Plan date: ".concat(j(e.plan_date))),s.push(""),s.push(e.summary.trim()),a.length>0&&(s.push(""),s.push("Highlights:"),a.forEach(e=>{s.push("• ".concat(e))})),e.detail.trim()&&0===a.length&&(s.push(""),s.push(e.detail.trim())),"number"==typeof n.horizonDays&&Number.isFinite(n.horizonDays)&&(s.push(""),s.push("Horizon: ".concat(n.horizonDays," days"))),s.join("\n").trimEnd()}(e,{horizonDays:b}),a="undefined"!=typeof navigator?navigator.clipboard:void 0;if(!(null==a?void 0:a.writeText))throw Error("Clipboard API unavailable");await a.writeText(n),B(null),I(t),R.current=window.setTimeout(()=>{I(e=>e===t?null:e),R.current=null},4e3)}catch(e){console.error("Failed to copy story briefing",e),I(null),B(t)}},[]);(0,r.useEffect)(()=>()=>{null!==R.current&&(window.clearTimeout(R.current),R.current=null)},[]);let T=null!==(t=null==c?void 0:c.stories)&&void 0!==t?t:[],P=(null==c?void 0:c.generated_at)?new Date(c.generated_at).toLocaleString():"—",O=null!==(n=null==c?void 0:c.context_tags)&&void 0!==n?n:[],A=null!==(a=null==c?void 0:c.context_warnings)&&void 0!==a?a:[],H=null!==(l=(null!==(s=null==c?void 0:null===(e=c.data_context)||void 0===e?void 0:e.metadata)&&void 0!==s?s:{}).weather_source)&&void 0!==l?l:"unknown";return(0,i.jsxs)(u.A,{children:[(0,i.jsx)(o(),{children:(0,i.jsx)("title",{children:"WeatherVane \xb7 Stories"})}),(0,i.jsxs)("div",{className:p().root,children:[(0,i.jsxs)("section",{className:p().header,children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"ds-title",children:"Weekly weather stories"}),(0,i.jsx)("p",{className:"ds-body",children:"Forecast-driven insights for the team. Each story blends anomalies, promo context, and incremental impact so you can ship a memo in minutes."})]}),(0,i.jsx)("aside",{className:p().meta,children:(0,i.jsxs)("dl",{children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Generated"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:P})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Horizon"}),(0,i.jsxs)("dd",{className:"ds-body-strong",children:[b," days"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("dt",{className:"ds-caption",children:"Total stories"}),(0,i.jsx)("dd",{className:"ds-body-strong",children:T.length})]})]})})]}),x&&(0,i.jsx)("p",{className:"".concat(p().status," ds-body"),role:"status","aria-live":"polite",children:"Loading stories…"}),v&&(0,i.jsxs)("div",{className:p().error,role:"alert",children:[(0,i.jsx)("p",{className:"ds-body",children:v}),(0,i.jsx)(_.P,{onClick:()=>L(e=>e+1),children:"Retry loading stories"})]}),!x&&!v&&(0,i.jsxs)("section",{className:p().contextSection,children:[(0,i.jsx)(h.O,{tags:O,warnings:A}),(0,i.jsxs)("div",{className:p().contextMeta,children:[(0,i.jsx)("span",{className:p().metaLabel,children:"Weather source"}),(0,i.jsx)("span",{className:p().metaValue,children:H})]})]}),!x&&!v&&(0,i.jsxs)("section",{className:p().grid,children:[T.map(e=>{var t;let n="".concat(e.plan_date,"-").concat(e.category,"-").concat(e.channel),a=f(e.detail,{limit:3}),s="/plan?source=stories&focus=".concat(encodeURIComponent(e.category),"&date=").concat(encodeURIComponent(e.plan_date)),r=S===n,l=E===n,o=r?"Briefing copied to clipboard.":l?"Copy failed. Use Cmd/Ctrl+C to share manually.":"";return(0,i.jsxs)("article",{children:[(0,i.jsxs)("header",{children:[(0,i.jsx)("span",{className:p().icon,"aria-hidden":!0,children:null!==(t=e.icon)&&void 0!==t?t:"\uD83C\uDF24"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"ds-title",children:e.title}),(0,i.jsxs)("div",{className:p().chipRow,children:[(0,i.jsx)("span",{className:p().chip,"data-variant":"channel",children:e.channel}),(0,i.jsxs)("span",{className:p().chip,"data-variant":"confidence","data-confidence":e.confidence,children:[e.confidence," confidence"]}),(0,i.jsx)("span",{className:p().chip,"data-variant":"date",children:j(e.plan_date)})]})]})]}),(0,i.jsx)("p",{className:"".concat(p().summary," ds-body"),children:e.summary}),a.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("ul",{className:p().highlightList,children:a.map(e=>(0,i.jsx)("li",{children:e},e))}),e.detail.trim()?(0,i.jsxs)("details",{className:p().detailDisclosure,children:[(0,i.jsx)("summary",{className:"ds-caption",children:"Full briefing"}),(0,i.jsx)("p",{className:"".concat(p().detail," ds-body"),children:e.detail})]}):null]}):e.detail.trim()?(0,i.jsx)("p",{className:"".concat(p().detail," ds-body"),children:e.detail}):null,(0,i.jsxs)("div",{className:p().cardActions,children:[(0,i.jsx)("button",{type:"button",onClick:()=>D(e),className:"ds-button","data-state":r?"success":l?"error":void 0,"data-variant":"primary",children:r?"Copied briefing":"Copy briefing"}),(0,i.jsx)(d(),{href:s,className:"ds-button","data-variant":"ghost",children:"Open in Plan"})]}),(0,i.jsx)("div",{className:o?"ds-status":"sr-only","data-tone":o?r?"success":l?"critical":"muted":void 0,role:"status","aria-live":"polite",children:o||" "})]},n)}),!T.length&&(0,i.jsxs)("article",{className:p().placeholder,children:[(0,i.jsx)("h3",{className:"ds-title",children:"No stories yet"}),(0,i.jsx)("p",{className:"ds-body",children:"Run the pipeline to generate weather-driven narratives. Stories will highlight the highest-confidence opportunities across your catalog."})]})]})]})]})}},5201:function(e){e.exports={panel:"context-panel_panel___QoO_",header:"context-panel_header__5j9dX",heading:"context-panel_heading__XERy_",tags:"context-panel_tags__cmUxz",warningList:"context-panel_warningList__Pls7N",warningItem:"context-panel_warningItem__kOu5x",warningInfo:"context-panel_warningInfo__NqfqL",warningCaution:"context-panel_warningCaution__XpMI7",warningCritical:"context-panel_warningCritical__joYO7",assignmentTable:"context-panel_assignmentTable__PLb2G",assignmentHeader:"context-panel_assignmentHeader__au_cv",assignmentRow:"context-panel_assignmentRow__ceDZw",summaryCard:"context-panel_summaryCard__cjOQY",summaryHeader:"context-panel_summaryHeader__IV8pS",liftValue:"context-panel_liftValue__h99_6",summaryGrid:"context-panel_summaryGrid__c2EOC",summaryMeta:"context-panel_summaryMeta___j10H",keyStats:"context-panel_keyStats__h_eYX",bodyCopy:"context-panel_bodyCopy__GZgZ0"}},1682:function(e){e.exports={retryButton:"retry-button_retryButton__857bg",retryButtonLoading:"retry-button_retryButtonLoading__h_n3Q",retryButtonSpinner:"retry-button_retryButtonSpinner__jIZZ_","retry-button-spin":"retry-button_retry-button-spin__xpbOc",retryButtonLabel:"retry-button_retryButtonLabel__Tfn2J"}},4612:function(e){e.exports={root:"stories_root__Id3gd",header:"stories_header__8Jpjf",meta:"stories_meta__aHIfF panel-surface_panelSurface__9kGI1",status:"stories_status__EKe62",error:"stories_error__RxZIR",contextSection:"stories_contextSection__Q5a8u",contextMeta:"stories_contextMeta__xhSVo",metaLabel:"stories_metaLabel__WW381",metaValue:"stories_metaValue__bU3_w",grid:"stories_grid__LDCZm",icon:"stories_icon___Sh99",summary:"stories_summary__t5wuB",chipRow:"stories_chipRow__QnnJH",chip:"stories_chip__Pe7jX",highlightList:"stories_highlightList__hmSkb",detail:"stories_detail__vroPg",detailDisclosure:"stories_detailDisclosure__63sLf",cardActions:"stories_cardActions___pGcV",placeholder:"stories_placeholder__xj9G_"}}},function(e){e.O(0,[717,570,589,888,774,179],function(){return e(e.s=8915)}),_N_E=e.O()}]);